clc
clear all
close all

%% FUNCTIONS
% The Hamiltonian 
function H = Hamiltonian(k,q,m,omega,v,U,W,ro,rv,rW,eta,alpha,V,beta,dist,d0)
    % Initialize the Hamiltonian 
    H = zeros(8);

    % The hat-parameters 
    Vh = V*exp(-dist/d0);
    betah = beta*exp(-dist/d0);

    % The parameters 1 and 2 
    omega1 = omega*(1+ro*m);
    omega2 = omega*(1-ro*m);
    v1 = v*(1+rv*m);
    v2 = v*(1-rv*m);
    U1 = U*(1+m); 
    U2 = U*(1-m);
    W1 = W*(1+rW*m);
    W2 = W*(1-rW*m);

    % The block (1,1)
    H(1,1) = eta + v1*k + omega1 + v1*k*k/sqrt(2);
    H(1,2) = W1;
    H(1,3) = W1;
    H(1,4) = U1*(1+alpha);

    H(2,1) = W1;
    H(2,2) = -eta + omega1 + v1*k*k/sqrt(2);
    H(2,3) = U1*(1-alpha);
    H(2,4) = W1;

    H(3,1) = W1;
    H(3,2) = U1*(1-alpha);
    H(3,3) = -eta + omega1 + v1*k*k/sqrt(2);
    H(3,4) = W1;

    H(4,1) = U1*(1+alpha);
    H(4,2) = W1;
    H(4,3) = W1;
    H(4,4) = eta - v1*k + omega1 + v1*k*k/sqrt(2);

    % Block (1,2)
    H(1,5) = -(Vh + betah*k + betah*k*k/sqrt(2))*exp(-i*2.0*pi*q);
    H(2,6) = Vh + betah*k*k/sqrt(2);
    H(3,7) = Vh + betah*k*k/sqrt(2);
    H(4,8) = -(Vh - betah*k + betah*k*k/sqrt(2))*exp(i*2.0*pi*q);

    % Block (2,1)
    H(5,1) = -(Vh + betah*k + betah*k*k/sqrt(2))*exp(i*2.0*pi*q);
    H(6,2) = Vh + betah*k*k/sqrt(2);
    H(7,3) = Vh + betah*k*k/sqrt(2);
    H(8,4) = -(Vh - betah*k + betah*k*k/sqrt(2))*exp(-i*2.0*pi*q);

    % Block (2,2)
    H(5,5) = eta + v2*k + omega2 + v2*k*k/sqrt(2);
    H(5,6) = W2;
    H(5,7) = W2;
    H(5,8) = U2*(1+alpha);

    H(6,5) = W2;
    H(6,6) = -eta + omega2 + v2*k*k/sqrt(2);
    H(6,7) = U2*(1-alpha);
    H(6,8) = W2;

    H(7,5) = W2;
    H(7,6) = U2*(1-alpha);
    H(7,7) = -eta + omega2 + v2*k*k/sqrt(2);
    H(7,8) = W2;

    H(8,5) = U2*(1+alpha);
    H(8,6) = W2;
    H(8,7) = W2;
    H(8,8) = eta - v2*k + omega2 + v2*k*k/sqrt(2);
end % function Hamiltonian 

% FUNCTION: Derivative of the Hamiltonian with respect to 
% the genuine momentum k 
function dHk = dH_k(k,q,m,v,rv,V,beta,dist,d0)
    dHk = zeros(8);

    betah = beta*exp(-dist/d0);

    v1 = v*(1+rv*m);
    v2 = v*(1-rv*m);

    % Block (1,1) 
    dHk(1,1) = v1 + sqrt(2)*v1*k;
    dHk(2,2) = sqrt(2)*v1*k;
    dHk(3,3) = sqrt(2)*v1*k;
    dHk(4,4) = -v1 + sqrt(2)*v1*k;

    % Block (1,2) 
    dHk(1,5) = -(betah + sqrt(2)*betah*k)*exp(-i*2.0*pi*q);
    dHk(2,6) = sqrt(2)*betah*k;
    dHk(3,7) = sqrt(2)*betah*k;
    dHk(4,8) = (betah - sqrt(2)*betah*k)*exp(i*2.0*pi*q);

    % Block (2,1)
    dHk(5,1) = -(betah + sqrt(2)*betah*k)*exp(i*2.0*pi*q);
    dHk(6,2) = sqrt(2)*betah*k;
    dHk(7,3) = sqrt(2)*betah*k;
    dHk(8,4) = (betah - sqrt(2)*betah*k)*exp(-i*2.0*pi*q);

    % Block (2,2) 
    dHk(5,5) = v2 + sqrt(2)*v2*k;
    dHk(6,6) = sqrt(2)*v2*k;
    dHk(7,7) = sqrt(2)*v2*k;
    dHk(8,8) = -v2 + sqrt(2)*v2*k;
end % function dHk 

% FUNCTION: Derivative of the Hamiltonian with respect to q 
function dHq = dH_q(k,q,V,beta,dist,d0)
    dHq = zeros(8);

    Vh = V*exp(-dist/d0);
    betah = beta*exp(-dist/d0);

    dHq(1,5) = i*2.0*pi*(Vh+betah*k+betah*k*k/sqrt(2))*exp(-i*2.0*pi*q);
    dHq(4,8) = -i*2.0*pi*(Vh-betah*k+betah*k*k/sqrt(2))*exp(i*2.0*pi*q);

    dHq(5,1) = -i*2.0*pi*(Vh+betah*k+betah*k*k/sqrt(2))*exp(i*2.0*pi*q);
    dHq(8,4) = i*2.0*pi*(Vh-betah*k+betah*k*k/sqrt(2))*exp(-i*2.0*pi*q);
end % function dH_q

% FUNCTION: Derivative of the Hamiltonian with respect to m 
function dHm = dH_m(k,omega,v,U,W,alpha,ro,rv,rW)
    dHm = zeros(8);

    % Block (1,1)
    dHm(1,1) = omega*ro + v*rv*k*k/sqrt(2) + v*rv*k;
    dHm(1,2) = W*rW;
    dHm(1,3) = W*rW;
    dHm(1,4) = U*(1+alpha);

    dHm(2,1) = W*rW;
    dHm(2,2) = omega*ro + v*rv*k*k/sqrt(2);
    dHm(2,3) = U*(1-alpha);
    dHm(2,4) = W*rW;

    dHm(3,1) = W*rW;
    dHm(3,2) = U*(1-alpha);
    dHm(3,3) = omega*ro + v*rv*k*k/sqrt(2);
    dHm(3,4) = W*rW;

    dHm(4,1) = U*(1+alpha);
    dHm(4,2) = W*rW;
    dHm(4,3) = W*rW;
    dHm(4,4) = omega*ro + v*rv*k*k/sqrt(2) - v*rv*k;

    % Block (2,2)
    dHm(5,5) = -dHm(1,1);
    dHm(5,6) = -dHm(1,2);
    dHm(5,7) = -dHm(1,3);
    dHm(5,8) = -dHm(1,4);

    dHm(6,5) = -dHm(2,1);
    dHm(6,6) = -dHm(2,2);
    dHm(6,7) = -dHm(2,3);
    dHm(6,8) = -dHm(2,4);

    dHm(7,5) = -dHm(3,1);
    dHm(7,6) = -dHm(3,2);
    dHm(7,7) = -dHm(3,3);
    dHm(7,8) = -dHm(3,4);

    dHm(8,5) = -dHm(4,1);
    dHm(8,6) = -dHm(4,2);
    dHm(8,7) = -dHm(4,3);
    dHm(8,8) = -dHm(4,4);
end % function dH_m 

%% The MAIN program goes here 
% The parameters 
mean_params = [0.29919014   0.31311088   -0.01525637   0.00175950];

omega = mean_params(1);
v = mean_params(2);
U = mean_params(3);
W = mean_params(4);

m = 0.1 % 0.27105218

ro = 0.1353
rv = 0.0892
rW = 2.4215

V = 0.039 
beta = -0.3
dist = 0.1
d0 = 0.35 

alpha = -0.062
eta = 0.0032

% The arrays of genuine and synthetic momenta, symmetry-breaking
% parameeters
Nk = 501
Kmax = 0.1
k_array = linspace(-Kmax,Kmax,Nk);

Nq = 501 
Qmax = 0.5
q_array = linspace(-Qmax,Qmax,Nq);

Nm = 501
Mmax = 0.2
m_array = linspace(-Mmax,Mmax,Nm);

% Berry map
Berry_map=[0,0,1;0.00708661417322835,0.00708661417322835,0.999212598425197;0.0141732283464567,0.0141732283464567,0.998425196850394;0.0212598425196850,0.0212598425196850,0.997637795275591;0.0283464566929134,0.0283464566929134,0.996850393700787;0.0354330708661417,0.0354330708661417,0.996062992125984;0.0425196850393701,0.0425196850393701,0.995275590551181;0.0496062992125984,0.0496062992125984,0.994488188976378;0.0566929133858268,0.0566929133858268,0.993700787401575;0.0637795275590551,0.0637795275590551,0.992913385826772;0.0708661417322835,0.0708661417322835,0.992125984251969;0.0779527559055118,0.0779527559055118,0.991338582677165;0.0850393700787402,0.0850393700787402,0.990551181102362;0.0921259842519685,0.0921259842519685,0.989763779527559;0.0992125984251969,0.0992125984251969,0.988976377952756;0.106299212598425,0.106299212598425,0.988188976377953;0.113385826771654,0.113385826771654,0.987401574803150;0.120472440944882,0.120472440944882,0.986614173228346;0.127559055118110,0.127559055118110,0.985826771653543;0.134645669291339,0.134645669291339,0.985039370078740;0.141732283464567,0.141732283464567,0.984251968503937;0.148818897637795,0.148818897637795,0.983464566929134;0.155905511811024,0.155905511811024,0.982677165354331;0.162992125984252,0.162992125984252,0.981889763779528;0.170078740157480,0.170078740157480,0.981102362204725;0.177165354330709,0.177165354330709,0.980314960629921;0.184251968503937,0.184251968503937,0.979527559055118;0.191338582677165,0.191338582677165,0.978740157480315;0.198425196850394,0.198425196850394,0.977952755905512;0.205511811023622,0.205511811023622,0.977165354330709;0.212598425196850,0.212598425196850,0.976377952755906;0.219685039370079,0.219685039370079,0.975590551181102;0.226771653543307,0.226771653543307,0.974803149606299;0.233858267716535,0.233858267716535,0.974015748031496;0.240944881889764,0.240944881889764,0.973228346456693;0.248031496062992,0.248031496062992,0.972440944881890;0.255118110236221,0.255118110236221,0.971653543307087;0.262204724409449,0.262204724409449,0.970866141732284;0.269291338582677,0.269291338582677,0.970078740157480;0.276377952755906,0.276377952755906,0.969291338582677;0.283464566929134,0.283464566929134,0.968503937007874;0.290551181102362,0.290551181102362,0.967716535433071;0.297637795275591,0.297637795275591,0.966929133858268;0.304724409448819,0.304724409448819,0.966141732283465;0.311811023622047,0.311811023622047,0.965354330708661;0.318897637795276,0.318897637795276,0.964566929133858;0.325984251968504,0.325984251968504,0.963779527559055;0.333070866141732,0.333070866141732,0.962992125984252;0.340157480314961,0.340157480314961,0.962204724409449;0.347244094488189,0.347244094488189,0.961417322834646;0.354330708661417,0.354330708661417,0.960629921259843;0.361417322834646,0.361417322834646,0.959842519685039;0.368503937007874,0.368503937007874,0.959055118110236;0.375590551181102,0.375590551181102,0.958267716535433;0.382677165354331,0.382677165354331,0.957480314960630;0.389763779527559,0.389763779527559,0.956692913385827;0.396850393700787,0.396850393700787,0.955905511811024;0.403937007874016,0.403937007874016,0.955118110236221;0.411023622047244,0.411023622047244,0.954330708661417;0.418110236220472,0.418110236220472,0.953543307086614;0.425196850393701,0.425196850393701,0.952755905511811;0.432283464566929,0.432283464566929,0.951968503937008;0.439370078740158,0.439370078740158,0.951181102362205;0.446456692913386,0.446456692913386,0.950393700787402;0.453543307086614,0.453543307086614,0.949606299212598;0.460629921259843,0.460629921259843,0.948818897637795;0.467716535433071,0.467716535433071,0.948031496062992;0.474803149606299,0.474803149606299,0.947244094488189;0.481889763779528,0.481889763779528,0.946456692913386;0.488976377952756,0.488976377952756,0.945669291338583;0.496062992125984,0.496062992125984,0.944881889763780;0.503149606299213,0.503149606299213,0.944094488188976;0.510236220472441,0.510236220472441,0.943307086614173;0.517322834645669,0.517322834645669,0.942519685039370;0.524409448818898,0.524409448818898,0.941732283464567;0.531496062992126,0.531496062992126,0.940944881889764;0.538582677165354,0.538582677165354,0.940157480314961;0.545669291338583,0.545669291338583,0.939370078740158;0.552755905511811,0.552755905511811,0.938582677165354;0.559842519685039,0.559842519685039,0.937795275590551;0.566929133858268,0.566929133858268,0.937007874015748;0.574015748031496,0.574015748031496,0.936220472440945;0.581102362204724,0.581102362204724,0.935433070866142;0.588188976377953,0.588188976377953,0.934645669291339;0.595275590551181,0.595275590551181,0.933858267716536;0.602362204724410,0.602362204724410,0.933070866141732;0.609448818897638,0.609448818897638,0.932283464566929;0.616535433070866,0.616535433070866,0.931496062992126;0.623622047244095,0.623622047244095,0.930708661417323;0.630708661417323,0.630708661417323,0.929921259842520;0.637795275590551,0.637795275590551,0.929133858267717;0.644881889763780,0.644881889763780,0.928346456692913;0.651968503937008,0.651968503937008,0.927559055118110;0.659055118110236,0.659055118110236,0.926771653543307;0.666141732283465,0.666141732283465,0.925984251968504;0.673228346456693,0.673228346456693,0.925196850393701;0.680314960629921,0.680314960629921,0.924409448818898;0.687401574803150,0.687401574803150,0.923622047244095;0.694488188976378,0.694488188976378,0.922834645669291;0.701574803149606,0.701574803149606,0.922047244094488;0.708661417322835,0.708661417322835,0.921259842519685;0.715748031496063,0.715748031496063,0.920472440944882;0.722834645669291,0.722834645669291,0.919685039370079;0.729921259842520,0.729921259842520,0.918897637795276;0.737007874015748,0.737007874015748,0.918110236220473;0.744094488188976,0.744094488188976,0.917322834645669;0.751181102362205,0.751181102362205,0.916535433070866;0.758267716535433,0.758267716535433,0.915748031496063;0.765354330708661,0.765354330708661,0.914960629921260;0.772440944881890,0.772440944881890,0.914173228346457;0.779527559055118,0.779527559055118,0.913385826771654;0.786614173228347,0.786614173228347,0.912598425196850;0.793700787401575,0.793700787401575,0.911811023622047;0.800787401574803,0.800787401574803,0.911023622047244;0.807874015748032,0.807874015748032,0.910236220472441;0.814960629921260,0.814960629921260,0.909448818897638;0.822047244094488,0.822047244094488,0.908661417322835;0.829133858267717,0.829133858267717,0.907874015748032;0.836220472440945,0.836220472440945,0.907086614173228;0.843307086614173,0.843307086614173,0.906299212598425;0.850393700787402,0.850393700787402,0.905511811023622;0.857480314960630,0.857480314960630,0.904724409448819;0.864566929133858,0.864566929133858,0.903937007874016;0.871653543307087,0.871653543307087,0.903149606299213;0.878740157480315,0.878740157480315,0.902362204724409;0.885826771653543,0.885826771653543,0.901574803149606;0.892913385826772,0.892913385826772,0.900787401574803;0.900000000000000,0.900000000000000,0.900000000000000;0.900781250000000,0.892968750000000,0.892968750000000;0.901562500000000,0.885937500000000,0.885937500000000;0.902343750000000,0.878906250000000,0.878906250000000;0.903125000000000,0.871875000000000,0.871875000000000;0.903906250000000,0.864843750000000,0.864843750000000;0.904687500000000,0.857812500000000,0.857812500000000;0.905468750000000,0.850781250000000,0.850781250000000;0.906250000000000,0.843750000000000,0.843750000000000;0.907031250000000,0.836718750000000,0.836718750000000;0.907812500000000,0.829687500000000,0.829687500000000;0.908593750000000,0.822656250000000,0.822656250000000;0.909375000000000,0.815625000000000,0.815625000000000;0.910156250000000,0.808593750000000,0.808593750000000;0.910937500000000,0.801562500000000,0.801562500000000;0.911718750000000,0.794531250000000,0.794531250000000;0.912500000000000,0.787500000000000,0.787500000000000;0.913281250000000,0.780468750000000,0.780468750000000;0.914062500000000,0.773437500000000,0.773437500000000;0.914843750000000,0.766406250000000,0.766406250000000;0.915625000000000,0.759375000000000,0.759375000000000;0.916406250000000,0.752343750000000,0.752343750000000;0.917187500000000,0.745312500000000,0.745312500000000;0.917968750000000,0.738281250000000,0.738281250000000;0.918750000000000,0.731250000000000,0.731250000000000;0.919531250000000,0.724218750000000,0.724218750000000;0.920312500000000,0.717187500000000,0.717187500000000;0.921093750000000,0.710156250000000,0.710156250000000;0.921875000000000,0.703125000000000,0.703125000000000;0.922656250000000,0.696093750000000,0.696093750000000;0.923437500000000,0.689062500000000,0.689062500000000;0.924218750000000,0.682031250000000,0.682031250000000;0.925000000000000,0.675000000000000,0.675000000000000;0.925781250000000,0.667968750000000,0.667968750000000;0.926562500000000,0.660937500000000,0.660937500000000;0.927343750000000,0.653906250000000,0.653906250000000;0.928125000000000,0.646875000000000,0.646875000000000;0.928906250000000,0.639843750000000,0.639843750000000;0.929687500000000,0.632812500000000,0.632812500000000;0.930468750000000,0.625781250000000,0.625781250000000;0.931250000000000,0.618750000000000,0.618750000000000;0.932031250000000,0.611718750000000,0.611718750000000;0.932812500000000,0.604687500000000,0.604687500000000;0.933593750000000,0.597656250000000,0.597656250000000;0.934375000000000,0.590625000000000,0.590625000000000;0.935156250000000,0.583593750000000,0.583593750000000;0.935937500000000,0.576562500000000,0.576562500000000;0.936718750000000,0.569531250000000,0.569531250000000;0.937500000000000,0.562500000000000,0.562500000000000;0.938281250000000,0.555468750000000,0.555468750000000;0.939062500000000,0.548437500000000,0.548437500000000;0.939843750000000,0.541406250000000,0.541406250000000;0.940625000000000,0.534375000000000,0.534375000000000;0.941406250000000,0.527343750000000,0.527343750000000;0.942187500000000,0.520312500000000,0.520312500000000;0.942968750000000,0.513281250000000,0.513281250000000;0.943750000000000,0.506250000000000,0.506250000000000;0.944531250000000,0.499218750000000,0.499218750000000;0.945312500000000,0.492187500000000,0.492187500000000;0.946093750000000,0.485156250000000,0.485156250000000;0.946875000000000,0.478125000000000,0.478125000000000;0.947656250000000,0.471093750000000,0.471093750000000;0.948437500000000,0.464062500000000,0.464062500000000;0.949218750000000,0.457031250000000,0.457031250000000;0.950000000000000,0.450000000000000,0.450000000000000;0.950781250000000,0.442968750000000,0.442968750000000;0.951562500000000,0.435937500000000,0.435937500000000;0.952343750000000,0.428906250000000,0.428906250000000;0.953125000000000,0.421875000000000,0.421875000000000;0.953906250000000,0.414843750000000,0.414843750000000;0.954687500000000,0.407812500000000,0.407812500000000;0.955468750000000,0.400781250000000,0.400781250000000;0.956250000000000,0.393750000000000,0.393750000000000;0.957031250000000,0.386718750000000,0.386718750000000;0.957812500000000,0.379687500000000,0.379687500000000;0.958593750000000,0.372656250000000,0.372656250000000;0.959375000000000,0.365625000000000,0.365625000000000;0.960156250000000,0.358593750000000,0.358593750000000;0.960937500000000,0.351562500000000,0.351562500000000;0.961718750000000,0.344531250000000,0.344531250000000;0.962500000000000,0.337500000000000,0.337500000000000;0.963281250000000,0.330468750000000,0.330468750000000;0.964062500000000,0.323437500000000,0.323437500000000;0.964843750000000,0.316406250000000,0.316406250000000;0.965625000000000,0.309375000000000,0.309375000000000;0.966406250000000,0.302343750000000,0.302343750000000;0.967187500000000,0.295312500000000,0.295312500000000;0.967968750000000,0.288281250000000,0.288281250000000;0.968750000000000,0.281250000000000,0.281250000000000;0.969531250000000,0.274218750000000,0.274218750000000;0.970312500000000,0.267187500000000,0.267187500000000;0.971093750000000,0.260156250000000,0.260156250000000;0.971875000000000,0.253125000000000,0.253125000000000;0.972656250000000,0.246093750000000,0.246093750000000;0.973437500000000,0.239062500000000,0.239062500000000;0.974218750000000,0.232031250000000,0.232031250000000;0.975000000000000,0.225000000000000,0.225000000000000;0.975781250000000,0.217968750000000,0.217968750000000;0.976562500000000,0.210937500000000,0.210937500000000;0.977343750000000,0.203906250000000,0.203906250000000;0.978125000000000,0.196875000000000,0.196875000000000;0.978906250000000,0.189843750000000,0.189843750000000;0.979687500000000,0.182812500000000,0.182812500000000;0.980468750000000,0.175781250000000,0.175781250000000;0.981250000000000,0.168750000000000,0.168750000000000;0.982031250000000,0.161718750000000,0.161718750000000;0.982812500000000,0.154687500000000,0.154687500000000;0.983593750000000,0.147656250000000,0.147656250000000;0.984375000000000,0.140625000000000,0.140625000000000;0.985156250000000,0.133593750000000,0.133593750000000;0.985937500000000,0.126562500000000,0.126562500000000;0.986718750000000,0.119531250000000,0.119531250000000;0.987500000000000,0.112500000000000,0.112500000000000;0.988281250000000,0.105468750000000,0.105468750000000;0.989062500000000,0.0984375000000000,0.0984375000000000;0.989843750000000,0.0914062500000000,0.0914062500000000;0.990625000000000,0.0843750000000000,0.0843750000000000;0.991406250000000,0.0773437500000000,0.0773437500000000;0.992187500000000,0.0703125000000000,0.0703125000000000;0.992968750000000,0.0632812500000000,0.0632812500000000;0.993750000000000,0.0562500000000000,0.0562500000000000;0.994531250000000,0.0492187500000000,0.0492187500000000;0.995312500000000,0.0421875000000000,0.0421875000000000;0.996093750000000,0.0351562500000000,0.0351562500000000;0.996875000000000,0.0281250000000000,0.0281250000000000;0.997656250000000,0.0210937500000000,0.0210937500000000;0.998437500000000,0.0140625000000000,0.0140625000000000;0.999218750000000,0.00703125000000004,0.00703125000000004;1,0,0];
Berry_map2=[0,0,0.500000000000000;0.000520929092357663,0.000520929092357663,0.501302322730894;0.00104185818471533,0.00104185818471533,0.502604645461789;0.00156278727707299,0.00156278727707299,0.503906968192683;0.00208371636943065,0.00208371636943065,0.505209290923577;0.00260464546178832,0.00260464546178832,0.506511613654471;0.00312557455414598,0.00312557455414598,0.507813936385365;0.00364650364650364,0.00364650364650364,0.509116259116259;0.00416743273886131,0.00416743273886131,0.510418581847153;0.00468836183121897,0.00468836183121897,0.511720904578048;0.00520929092357664,0.00520929092357664,0.513023227308942;0.00573022001593430,0.00573022001593430,0.514325550039836;0.00625114910829197,0.00625114910829197,0.515627872770730;0.00677207820064963,0.00677207820064963,0.516930195501624;0.00729300729300730,0.00729300729300730,0.518232518232518;0.00781393638536496,0.00781393638536496,0.519534840963412;0.00833486547772263,0.00833486547772263,0.520837163694306;0.00885579457008030,0.00885579457008030,0.522139486425201;0.00937672366243797,0.00937672366243797,0.523441809156095;0.00989765275479565,0.00989765275479565,0.524744131886989;0.0104185818471533,0.0104185818471533,0.526046454617884;0.0109395109395110,0.0109395109395110,0.527348777348778;0.0114604400318686,0.0114604400318686,0.528651100079672;0.0119813691242263,0.0119813691242263,0.529953422810566;0.0125022982165840,0.0125022982165840,0.531255745541460;0.0130232273089416,0.0130232273089416,0.532558068272354;0.0135441564012993,0.0135441564012993,0.533860391003248;0.0140650854936569,0.0140650854936569,0.535162713734143;0.0145860145860146,0.0145860145860146,0.536465036465037;0.0151069436783723,0.0151069436783723,0.537767359195931;0.0156278727707299,0.0156278727707299,0.539069681926825;0.0161488018630876,0.0161488018630876,0.540372004657719;0.0166697309554452,0.0166697309554452,0.541674327388613;0.0171906600478029,0.0171906600478029,0.542976650119507;0.0177115891401606,0.0177115891401606,0.544278972850402;0.0182325182325182,0.0182325182325182,0.545581295581296;0.0187534473248759,0.0187534473248759,0.546883618312190;0.0192743764172335,0.0192743764172335,0.548185941043084;0.0197953055095912,0.0197953055095912,0.549488263773978;0.0203162346019489,0.0203162346019489,0.550790586504872;0.0208371636943065,0.0208371636943065,0.552092909235766;0.0213580927866642,0.0213580927866642,0.553395231966660;0.0218790218790218,0.0218790218790218,0.554697554697555;0.0223999509713795,0.0223999509713795,0.555999877428449;0.0229208800637372,0.0229208800637372,0.557302200159343;0.0234418091560949,0.0234418091560949,0.558604522890237;0.0239627382484526,0.0239627382484526,0.559906845621131;0.0244836673408103,0.0244836673408103,0.561209168352025;0.0250045964331679,0.0250045964331679,0.562511491082919;0.0255255255255256,0.0255255255255256,0.563813813813814;0.0260464546178832,0.0260464546178832,0.565116136544708;0.0265673837102409,0.0265673837102409,0.566418459275602;0.0270883128025986,0.0270883128025986,0.567720782006496;0.0276092418949562,0.0276092418949562,0.569023104737390;0.0281301709873139,0.0281301709873139,0.570325427468284;0.0286511000796715,0.0286511000796715,0.571627750199178;0.0291720291720292,0.0291720291720292,0.572930072930073;0.0296929582643869,0.0296929582643869,0.574232395660967;0.0302138873567445,0.0302138873567445,0.575534718391861;0.0307348164491022,0.0307348164491022,0.576837041122756;0.0312557455414598,0.0312557455414598,0.578139363853650;0.0317766746338175,0.0317766746338175,0.579441686584544;0.0322976037261752,0.0322976037261752,0.580744009315438;0.0328185328185328,0.0328185328185328,0.582046332046333;0.0333394619108905,0.0333394619108905,0.583348654777227;0.0338603910032481,0.0338603910032481,0.584650977508121;0.0343813200956058,0.0343813200956058,0.585953300239015;0.0349022491879635,0.0349022491879635,0.587255622969909;0.0354231782803211,0.0354231782803211,0.588557945700803;0.0359441073726788,0.0359441073726788,0.589860268431697;0.0364650364650365,0.0364650364650365,0.591162591162592;0.0369859655573941,0.0369859655573941,0.592464913893486;0.0375068946497518,0.0375068946497518,0.593767236624380;0.0380278237421094,0.0380278237421094,0.595069559355274;0.0385487528344671,0.0385487528344671,0.596371882086168;0.0390696819268248,0.0390696819268248,0.597674204817062;0.0395906110191824,0.0395906110191824,0.598976527547956;0.0401115401115401,0.0401115401115401,0.600278850278851;0.0406324692038978,0.0406324692038978,0.601581173009745;0.0411533982962555,0.0411533982962555,0.602883495740639;0.0416743273886132,0.0416743273886132,0.604185818471533;0.0421952564809708,0.0421952564809708,0.605488141202427;0.0427161855733285,0.0427161855733285,0.606790463933321;0.0432371146656861,0.0432371146656861,0.608092786664215;0.0437580437580438,0.0437580437580438,0.609395109395110;0.0442789728504015,0.0442789728504015,0.610697432126004;0.0447999019427591,0.0447999019427591,0.611999754856898;0.0453208310351168,0.0453208310351168,0.613302077587792;0.0458417601274744,0.0458417601274744,0.614604400318686;0.0463626892198321,0.0463626892198321,0.615906723049580;0.0468836183121898,0.0468836183121898,0.617209045780474;0.0474045474045474,0.0474045474045474,0.618511368511368;0.0479254764969051,0.0479254764969051,0.619813691242263;0.0484464055892628,0.0484464055892628,0.621116013973157;0.0489673346816204,0.0489673346816204,0.622418336704051;0.0494882637739781,0.0494882637739781,0.623720659434945;0.0500091928663357,0.0500091928663357,0.625022982165839;0.0505301219586934,0.0505301219586934,0.626325304896733;0.0510510510510511,0.0510510510510511,0.627627627627627;0.0515719801434087,0.0515719801434087,0.628929950358522;0.0520929092357664,0.0520929092357664,0.630232273089416;0.0526138383281240,0.0526138383281240,0.631534595820310;0.0531347674204817,0.0531347674204817,0.632836918551205;0.0536556965128394,0.0536556965128394,0.634139241282099;0.0541766256051970,0.0541766256051970,0.635441564012993;0.0546975546975547,0.0546975546975547,0.636743886743887;0.0552184837899123,0.0552184837899123,0.638046209474781;0.0557394128822700,0.0557394128822700,0.639348532205675;0.0562603419746277,0.0562603419746277,0.640650854936569;0.0567812710669853,0.0567812710669853,0.641953177667463;0.0573022001593430,0.0573022001593430,0.643255500398358;0.0578231292517007,0.0578231292517007,0.644557823129252;0.0583440583440584,0.0583440583440584,0.645860145860146;0.0588649874364160,0.0588649874364160,0.647162468591040;0.0593859165287737,0.0593859165287737,0.648464791321934;0.0599068456211314,0.0599068456211314,0.649767114052828;0.0604277747134890,0.0604277747134890,0.651069436783722;0.0609487038058467,0.0609487038058467,0.652371759514617;0.0614696328982044,0.0614696328982044,0.653674082245511;0.0619905619905620,0.0619905619905620,0.654976404976405;0.0625114910829197,0.0625114910829197,0.656278727707300;0.0630324201752773,0.0630324201752773,0.657581050438194;0.0635533492676350,0.0635533492676350,0.658883373169088;0.0640742783599927,0.0640742783599927,0.660185695899982;0.0645952074523503,0.0645952074523503,0.661488018630876;0.0651161365447080,0.0651161365447080,0.662790341361770;0.0656370656370656,0.0656370656370656,0.664092664092664;0.0661579947294233,0.0661579947294233,0.665394986823559;0.0666789238217810,0.0666789238217810,0.666697309554453;0.0671998529141386,0.0671998529141386,0.667999632285347;0.0677207820064963,0.0677207820064963,0.669301955016241;0.0682417110988540,0.0682417110988540,0.670604277747135;0.0687626401912116,0.0687626401912116,0.671906600478029;0.0692835692835693,0.0692835692835693,0.673208923208923;0.0698044983759269,0.0698044983759269,0.674511245939818;0.0703254274682846,0.0703254274682846,0.675813568670712;0.0708463565606423,0.0708463565606423,0.677115891401606;0.0713672856529999,0.0713672856529999,0.678418214132500;0.0718882147453576,0.0718882147453576,0.679720536863394;0.0724091438377153,0.0724091438377153,0.681022859594288;0.0729300729300730,0.0729300729300730,0.682325182325182;0.0734510020224307,0.0734510020224307,0.683627505056076;0.0739719311147883,0.0739719311147883,0.684929827786971;0.0744928602071460,0.0744928602071460,0.686232150517865;0.0750137892995036,0.0750137892995036,0.687534473248759;0.0755347183918613,0.0755347183918613,0.688836795979653;0.0760556474842190,0.0760556474842190,0.690139118710548;0.0765765765765766,0.0765765765765766,0.691441441441442;0.0770975056689343,0.0770975056689343,0.692743764172336;0.0776184347612919,0.0776184347612919,0.694046086903230;0.0781393638536496,0.0781393638536496,0.695348409634124;0.0786602929460073,0.0786602929460073,0.696650732365018;0.0791812220383649,0.0791812220383649,0.697953055095912;0.0797021511307226,0.0797021511307226,0.699255377826807;0.0802230802230802,0.0802230802230802,0.700557700557701;0.0807440093154379,0.0807440093154379,0.701860023288595;0.0812649384077956,0.0812649384077956,0.703162346019489;0.0817858675001532,0.0817858675001532,0.704464668750383;0.0823067965925109,0.0823067965925109,0.705766991481277;0.0828277256848685,0.0828277256848685,0.707069314212172;0.0833486547772262,0.0833486547772262,0.708371636943066;0.0838695838695839,0.0838695838695839,0.709673959673960;0.0843905129619415,0.0843905129619415,0.710976282404854;0.0849114420542992,0.0849114420542992,0.712278605135748;0.0854323711466569,0.0854323711466569,0.713580927866642;0.0859533002390145,0.0859533002390145,0.714883250597536;0.0864742293313722,0.0864742293313722,0.716185573328430;0.0869951584237298,0.0869951584237298,0.717487896059325;0.0875160875160875,0.0875160875160875,0.718790218790219;0.0880370166084452,0.0880370166084452,0.720092541521113;0.0885579457008029,0.0885579457008029,0.721394864252007;0.0890788747931605,0.0890788747931605,0.722697186982901;0.0895998038855182,0.0895998038855182,0.723999509713795;0.0901207329778759,0.0901207329778759,0.725301832444689;0.0906416620702336,0.0906416620702336,0.726604155175584;0.0911625911625912,0.0911625911625912,0.727906477906478;0.0916835202549489,0.0916835202549489,0.729208800637372;0.0922044493473065,0.0922044493473065,0.730511123368266;0.0927253784396642,0.0927253784396642,0.731813446099160;0.0932463075320219,0.0932463075320219,0.733115768830054;0.0937672366243795,0.0937672366243795,0.734418091560948;0.0942881657167372,0.0942881657167372,0.735720414291843;0.0948090948090948,0.0948090948090948,0.737022737022737;0.0953300239014525,0.0953300239014525,0.738325059753631;0.0958509529938102,0.0958509529938102,0.739627382484525;0.0963718820861678,0.0963718820861678,0.740929705215420;0.0968928111785255,0.0968928111785255,0.742232027946314;0.0974137402708832,0.0974137402708832,0.743534350677208;0.0979346693632408,0.0979346693632408,0.744836673408102;0.0984555984555985,0.0984555984555985,0.746138996138997;0.0989765275479561,0.0989765275479561,0.747441318869891;0.0994974566403138,0.0994974566403138,0.748743641600785;0.100018385732671,0.100018385732671,0.750045964331679;0.100539314825029,0.100539314825029,0.751348287062573;0.101060243917387,0.101060243917387,0.752650609793467;0.101581173009745,0.101581173009745,0.753952932524362;0.102102102102102,0.102102102102102,0.755255255255256;0.102623031194460,0.102623031194460,0.756557577986150;0.103143960286818,0.103143960286818,0.757859900717044;0.103664889379175,0.103664889379175,0.759162223447938;0.104185818471533,0.104185818471533,0.760464546178832;0.104706747563890,0.104706747563890,0.761766868909726;0.105227676656248,0.105227676656248,0.763069191640620;0.105748605748606,0.105748605748606,0.764371514371515;0.106269534840964,0.106269534840964,0.765673837102409;0.106790463933321,0.106790463933321,0.766976159833303;0.107311393025679,0.107311393025679,0.768278482564197;0.107832322118036,0.107832322118036,0.769580805295091;0.108353251210394,0.108353251210394,0.770883128025985;0.108874180302751,0.108874180302751,0.772185450756879;0.109395109395109,0.109395109395109,0.773487773487774;0.109916038487467,0.109916038487467,0.774790096218668;0.110436967579825,0.110436967579825,0.776092418949562;0.110957896672182,0.110957896672182,0.777394741680456;0.111478825764540,0.111478825764540,0.778697064411350;0.111999754856898,0.111999754856898,0.779999387142244;0.112520683949256,0.112520683949256,0.781301709873138;0.113041613041613,0.113041613041613,0.782604032604033;0.113562542133971,0.113562542133971,0.783906355334927;0.114083471226328,0.114083471226328,0.785208678065821;0.114604400318686,0.114604400318686,0.786511000796715;0.115125329411044,0.115125329411044,0.787813323527609;0.115646258503401,0.115646258503401,0.789115646258503;0.116167187595759,0.116167187595759,0.790417968989397;0.116688116688117,0.116688116688117,0.791720291720292;0.117209045780475,0.117209045780475,0.793022614451186;0.117729974872832,0.117729974872832,0.794324937182080;0.118250903965190,0.118250903965190,0.795627259912974;0.118771833057548,0.118771833057548,0.796929582643869;0.119292762149905,0.119292762149905,0.798231905374763;0.119813691242263,0.119813691242263,0.799534228105657;0.120334620334620,0.120334620334620,0.800836550836551;0.120855549426978,0.120855549426978,0.802138873567445;0.121376478519336,0.121376478519336,0.803441196298339;0.121897407611693,0.121897407611693,0.804743519029233;0.122418336704051,0.122418336704051,0.806045841760128;0.122939265796409,0.122939265796409,0.807348164491022;0.123460194888766,0.123460194888766,0.808650487221916;0.123981123981124,0.123981123981124,0.809952809952810;0.124502053073481,0.124502053073481,0.811255132683704;0.125022982165839,0.125022982165839,0.812557455414598;0.125543911258197,0.125543911258197,0.813859778145492;0.126064840350555,0.126064840350555,0.815162100876387;0.126585769442912,0.126585769442912,0.816464423607281;0.127106698535270,0.127106698535270,0.817766746338175;0.127627627627628,0.127627627627628,0.819069069069069;0.128148556719986,0.128148556719986,0.820371391799963;0.128669485812343,0.128669485812343,0.821673714530857;0.129190414904701,0.129190414904701,0.822976037261751;0.129711343997058,0.129711343997058,0.824278359992646;0.130232273089416,0.130232273089416,0.825580682723540;0.130753202181773,0.130753202181773,0.826883005454434;0.131274131274131,0.131274131274131,0.828185328185328;0.131795060366489,0.131795060366489,0.829487650916223;0.132315989458847,0.132315989458847,0.830789973647117;0.132836918551204,0.132836918551204,0.832092296378011;0.133357847643562,0.133357847643562,0.833394619108905;0.133878776735919,0.133878776735919,0.834696941839799;0.134399705828277,0.134399705828277,0.835999264570693;0.134920634920635,0.134920634920635,0.837301587301587;0.135441564012992,0.135441564012992,0.838603910032482;0.135962493105350,0.135962493105350,0.839906232763376;0.136483422197708,0.136483422197708,0.841208555494270;0.137004351290066,0.137004351290066,0.842510878225164;0.137525280382423,0.137525280382423,0.843813200956058;0.138046209474781,0.138046209474781,0.845115523686952;0.138567138567139,0.138567138567139,0.846417846417846;0.139088067659497,0.139088067659497,0.847720169148741;0.139608996751854,0.139608996751854,0.849022491879635;0.140129925844212,0.140129925844212,0.850324814610529;0.140650854936569,0.140650854936569,0.851627137341423;0.141171784028927,0.141171784028927,0.852929460072317;0.141692713121284,0.141692713121284,0.854231782803212;0.142213642213642,0.142213642213642,0.855534105534106;0.142734571306000,0.142734571306000,0.856836428265000;0.143255500398358,0.143255500398358,0.858138750995894;0.143776429490715,0.143776429490715,0.859441073726788;0.144297358583073,0.144297358583073,0.860743396457683;0.144818287675430,0.144818287675430,0.862045719188577;0.145339216767788,0.145339216767788,0.863348041919471;0.145860145860146,0.145860145860146,0.864650364650365;0.146381074952503,0.146381074952503,0.865952687381259;0.146902004044861,0.146902004044861,0.867255010112153;0.147422933137219,0.147422933137219,0.868557332843047;0.147943862229577,0.147943862229577,0.869859655573941;0.148464791321934,0.148464791321934,0.871161978304836;0.148985720414292,0.148985720414292,0.872464301035730;0.149506649506650,0.149506649506650,0.873766623766624;0.150027578599007,0.150027578599007,0.875068946497518;0.150548507691365,0.150548507691365,0.876371269228412;0.151069436783722,0.151069436783722,0.877673591959306;0.151590365876080,0.151590365876080,0.878975914690200;0.152111294968438,0.152111294968438,0.880278237421095;0.152632224060796,0.152632224060796,0.881580560151989;0.153153153153153,0.153153153153153,0.882882882882883;0.153674082245511,0.153674082245511,0.884185205613777;0.154195011337869,0.154195011337869,0.885487528344671;0.154715940430227,0.154715940430227,0.886789851075565;0.155236869522584,0.155236869522584,0.888092173806459;0.155757798614942,0.155757798614942,0.889394496537354;0.156278727707299,0.156278727707299,0.890696819268248;0.156799656799657,0.156799656799657,0.891999141999142;0.157320585892014,0.157320585892014,0.893301464730036;0.157841514984372,0.157841514984372,0.894603787460930;0.158362444076730,0.158362444076730,0.895906110191824;0.158883373169088,0.158883373169088,0.897208432922718;0.159404302261445,0.159404302261445,0.898510755653613;0.159925231353803,0.159925231353803,0.899813078384507;0.160446160446160,0.160446160446160,0.901115401115401;0.160967089538518,0.160967089538518,0.902417723846295;0.161488018630875,0.161488018630875,0.903720046577190;0.162008947723233,0.162008947723233,0.905022369308084;0.162529876815591,0.162529876815591,0.906324692038978;0.163050805907949,0.163050805907949,0.907627014769872;0.163571735000307,0.163571735000307,0.908929337500767;0.164092664092664,0.164092664092664,0.910231660231661;0.164613593185022,0.164613593185022,0.911533982962555;0.165134522277380,0.165134522277380,0.912836305693449;0.165655451369737,0.165655451369737,0.914138628424343;0.166176380462095,0.166176380462095,0.915440951155237;0.166697309554452,0.166697309554452,0.916743273886131;0.167218238646810,0.167218238646810,0.918045596617026;0.167739167739168,0.167739167739168,0.919347919347920;0.168260096831525,0.168260096831525,0.920650242078814;0.168781025923883,0.168781025923883,0.921952564809708;0.169301955016241,0.169301955016241,0.923254887540602;0.169822884108598,0.169822884108598,0.924557210271496;0.170343813200956,0.170343813200956,0.925859533002390;0.170864742293313,0.170864742293313,0.927161855733285;0.171385671385671,0.171385671385671,0.928464178464179;0.171906600478029,0.171906600478029,0.929766501195073;0.172427529570386,0.172427529570386,0.931068823925967;0.172948458662744,0.172948458662744,0.932371146656861;0.173469387755102,0.173469387755102,0.933673469387755;0.173990316847460,0.173990316847460,0.934975792118649;0.174511245939818,0.174511245939818,0.936278114849544;0.175032175032175,0.175032175032175,0.937580437580438;0.175553104124533,0.175553104124533,0.938882760311332;0.176074033216891,0.176074033216891,0.940185083042226;0.176594962309248,0.176594962309248,0.941487405773120;0.177115891401606,0.177115891401606,0.942789728504014;0.177636820493963,0.177636820493963,0.944092051234908;0.178157749586321,0.178157749586321,0.945394373965803;0.178678678678679,0.178678678678679,0.946696696696697;0.179199607771036,0.179199607771036,0.947999019427591;0.179720536863394,0.179720536863394,0.949301342158485;0.180241465955752,0.180241465955752,0.950603664889379;0.180762395048110,0.180762395048110,0.951905987620273;0.181283324140467,0.181283324140467,0.953208310351167;0.181804253232825,0.181804253232825,0.954510633082062;0.182325182325183,0.182325182325183,0.955812955812956;0.182846111417540,0.182846111417540,0.957115278543850;0.183367040509898,0.183367040509898,0.958417601274744;0.183887969602255,0.183887969602255,0.959719924005639;0.184408898694613,0.184408898694613,0.961022246736533;0.184929827786971,0.184929827786971,0.962324569467427;0.185450756879329,0.185450756879329,0.963626892198321;0.185971685971686,0.185971685971686,0.964929214929215;0.186492615064044,0.186492615064044,0.966231537660109;0.187013544156401,0.187013544156401,0.967533860391003;0.187534473248759,0.187534473248759,0.968836183121898;0.188055402341116,0.188055402341116,0.970138505852792;0.188576331433474,0.188576331433474,0.971440828583686;0.189097260525832,0.189097260525832,0.972743151314580;0.189618189618190,0.189618189618190,0.974045474045474;0.190139118710547,0.190139118710547,0.975347796776368;0.190660047802905,0.190660047802905,0.976650119507262;0.191180976895263,0.191180976895263,0.977952442238157;0.191701905987621,0.191701905987621,0.979254764969051;0.192222835079978,0.192222835079978,0.980557087699945;0.192743764172336,0.192743764172336,0.981859410430839;0.193264693264693,0.193264693264693,0.983161733161733;0.193785622357051,0.193785622357051,0.984464055892627;0.194306551449408,0.194306551449408,0.985766378623521;0.194827480541766,0.194827480541766,0.987068701354416;0.195348409634124,0.195348409634124,0.988371024085310;0.195869338726482,0.195869338726482,0.989673346816204;0.196390267818839,0.196390267818839,0.990975669547098;0.196911196911197,0.196911196911197,0.992277992277993;0.197432126003554,0.197432126003554,0.993580315008887;0.197953055095912,0.197953055095912,0.994882637739781;0.198473984188270,0.198473984188270,0.996184960470675;0.198994913280627,0.198994913280627,0.997487283201569;0.199515842372985,0.199515842372985,0.998789605932463;0.200420420420420,0.200420420420420,0.999939939939940;0.206376376376376,0.206376376376376,0.999089089089089;0.212332332332332,0.212332332332332,0.998238238238238;0.218288288288288,0.218288288288288,0.997387387387388;0.224244244244244,0.224244244244244,0.996536536536537;0.230200200200200,0.230200200200200,0.995685685685686;0.236156156156156,0.236156156156156,0.994834834834835;0.242112112112112,0.242112112112112,0.993983983983984;0.248068068068069,0.248068068068069,0.993133133133133;0.254024024024024,0.254024024024024,0.992282282282282;0.259979979979980,0.259979979979980,0.991431431431431;0.265935935935936,0.265935935935936,0.990580580580581;0.271891891891892,0.271891891891892,0.989729729729730;0.277847847847848,0.277847847847848,0.988878878878879;0.283803803803804,0.283803803803804,0.988028028028028;0.289759759759759,0.289759759759759,0.987177177177178;0.295715715715716,0.295715715715716,0.986326326326327;0.301671671671672,0.301671671671672,0.985475475475476;0.307627627627628,0.307627627627628,0.984624624624625;0.313583583583584,0.313583583583584,0.983773773773773;0.319539539539540,0.319539539539540,0.982922922922923;0.325495495495496,0.325495495495496,0.982072072072072;0.331451451451452,0.331451451451452,0.981221221221221;0.337407407407407,0.337407407407407,0.980370370370370;0.343363363363363,0.343363363363363,0.979519519519520;0.349319319319319,0.349319319319319,0.978668668668669;0.355275275275275,0.355275275275275,0.977817817817818;0.361231231231231,0.361231231231231,0.976966966966967;0.367187187187187,0.367187187187187,0.976116116116116;0.373143143143143,0.373143143143143,0.975265265265265;0.379099099099099,0.379099099099099,0.974414414414414;0.385055055055055,0.385055055055055,0.973563563563563;0.391011011011011,0.391011011011011,0.972712712712712;0.396966966966967,0.396966966966967,0.971861861861862;0.402922922922923,0.402922922922923,0.971011011011011;0.408878878878879,0.408878878878879,0.970160160160160;0.414834834834835,0.414834834834835,0.969309309309309;0.420790790790791,0.420790790790791,0.968458458458459;0.426746746746747,0.426746746746747,0.967607607607608;0.432702702702702,0.432702702702702,0.966756756756757;0.438658658658659,0.438658658658659,0.965905905905906;0.444614614614615,0.444614614614615,0.965055055055055;0.450570570570571,0.450570570570571,0.964204204204204;0.456526526526527,0.456526526526527,0.963353353353353;0.462482482482483,0.462482482482483,0.962502502502502;0.468438438438439,0.468438438438439,0.961651651651652;0.474394394394394,0.474394394394394,0.960800800800801;0.480350350350350,0.480350350350350,0.959949949949950;0.486306306306306,0.486306306306306,0.959099099099099;0.492262262262262,0.492262262262262,0.958248248248248;0.498218218218218,0.498218218218218,0.957397397397398;0.504174174174174,0.504174174174174,0.956546546546547;0.510130130130130,0.510130130130130,0.955695695695696;0.516086086086086,0.516086086086086,0.954844844844845;0.522042042042042,0.522042042042042,0.953993993993994;0.527997997997998,0.527997997997998,0.953143143143143;0.533953953953954,0.533953953953954,0.952292292292292;0.539909909909910,0.539909909909910,0.951441441441441;0.545865865865866,0.545865865865866,0.950590590590591;0.551821821821822,0.551821821821822,0.949739739739740;0.557777777777778,0.557777777777778,0.948888888888889;0.563733733733734,0.563733733733734,0.948038038038038;0.569689689689690,0.569689689689690,0.947187187187187;0.575645645645645,0.575645645645645,0.946336336336337;0.581601601601602,0.581601601601602,0.945485485485486;0.587557557557558,0.587557557557558,0.944634634634635;0.593513513513514,0.593513513513514,0.943783783783784;0.599469469469470,0.599469469469470,0.942932932932933;0.605425425425426,0.605425425425426,0.942082082082082;0.611381381381382,0.611381381381382,0.941231231231231;0.617337337337337,0.617337337337337,0.940380380380380;0.623293293293293,0.623293293293293,0.939529529529529;0.629249249249249,0.629249249249249,0.938678678678679;0.635205205205205,0.635205205205205,0.937827827827828;0.641161161161161,0.641161161161161,0.936976976976977;0.647117117117117,0.647117117117117,0.936126126126126;0.653073073073073,0.653073073073073,0.935275275275275;0.659029029029029,0.659029029029029,0.934424424424424;0.664984984984985,0.664984984984985,0.933573573573573;0.670940940940941,0.670940940940941,0.932722722722723;0.676896896896897,0.676896896896897,0.931871871871872;0.682852852852853,0.682852852852853,0.931021021021021;0.688808808808809,0.688808808808809,0.930170170170170;0.694764764764765,0.694764764764765,0.929319319319319;0.700720720720720,0.700720720720720,0.928468468468469;0.706676676676676,0.706676676676676,0.927617617617618;0.712632632632632,0.712632632632632,0.926766766766767;0.718588588588589,0.718588588588589,0.925915915915916;0.724544544544545,0.724544544544545,0.925065065065065;0.730500500500501,0.730500500500501,0.924214214214214;0.736456456456457,0.736456456456457,0.923363363363363;0.742412412412413,0.742412412412413,0.922512512512512;0.748368368368369,0.748368368368369,0.921661661661662;0.754324324324325,0.754324324324325,0.920810810810811;0.760280280280280,0.760280280280280,0.919959959959960;0.766236236236236,0.766236236236236,0.919109109109109;0.772192192192192,0.772192192192192,0.918258258258258;0.778148148148148,0.778148148148148,0.917407407407408;0.784104104104104,0.784104104104104,0.916556556556557;0.790060060060060,0.790060060060060,0.915705705705706;0.796016016016016,0.796016016016016,0.914854854854855;0.801971971971972,0.801971971971972,0.914004004004004;0.807927927927928,0.807927927927928,0.913153153153153;0.813883883883884,0.813883883883884,0.912302302302302;0.819839839839840,0.819839839839840,0.911451451451451;0.825795795795796,0.825795795795796,0.910600600600601;0.831751751751752,0.831751751751752,0.909749749749750;0.837707707707708,0.837707707707708,0.908898898898899;0.843663663663664,0.843663663663664,0.908048048048048;0.849619619619619,0.849619619619619,0.907197197197198;0.855575575575575,0.855575575575575,0.906346346346347;0.861531531531532,0.861531531531532,0.905495495495496;0.867487487487488,0.867487487487488,0.904644644644645;0.873443443443444,0.873443443443444,0.903793793793793;0.879399399399400,0.879399399399400,0.902942942942943;0.885355355355355,0.885355355355355,0.902092092092092;0.891311311311312,0.891311311311312,0.901241241241241;0.897267267267267,0.897267267267267,0.900390390390390;0.900476338407373,0.896665631148390,0.896665631148390;0.901356528942736,0.890504297400849,0.890504297400849;0.902236719478099,0.884342963653308,0.884342963653308;0.903116910013462,0.878181629905768,0.878181629905768;0.903997100548825,0.872020296158227,0.872020296158227;0.904877291084188,0.865858962410686,0.865858962410687;0.905757481619551,0.859697628663146,0.859697628663146;0.906637672154914,0.853536294915605,0.853536294915605;0.907517862690277,0.847374961168064,0.847374961168065;0.908398053225640,0.841213627420524,0.841213627420524;0.909278243761003,0.835052293672983,0.835052293672983;0.910158434296365,0.828890959925443,0.828890959925443;0.911038624831729,0.822729626177902,0.822729626177902;0.911918815367091,0.816568292430361,0.816568292430361;0.912799005902454,0.810406958682821,0.810406958682821;0.913679196437817,0.804245624935280,0.804245624935280;0.914559386973180,0.798084291187739,0.798084291187739;0.915439577508543,0.791922957440199,0.791922957440199;0.916319768043906,0.785761623692658,0.785761623692658;0.917199958579269,0.779600289945117,0.779600289945117;0.918080149114632,0.773438956197576,0.773438956197577;0.918960339649995,0.767277622450036,0.767277622450037;0.919840530185358,0.761116288702495,0.761116288702496;0.920720720720721,0.754954954954954,0.754954954954955;0.921600911256084,0.748793621207414,0.748793621207415;0.922481101791447,0.742632287459874,0.742632287459874;0.923361292326810,0.736470953712333,0.736470953712333;0.924241482862173,0.730309619964793,0.730309619964793;0.925121673397536,0.724148286217252,0.724148286217252;0.926001863932899,0.717986952469711,0.717986952469711;0.926882054468262,0.711825618722171,0.711825618722171;0.927762245003625,0.705664284974630,0.705664284974630;0.928642435538988,0.699502951227089,0.699502951227089;0.929522626074351,0.693341617479548,0.693341617479548;0.930402816609713,0.687180283732008,0.687180283732008;0.931283007145076,0.681018949984467,0.681018949984467;0.932163197680439,0.674857616236926,0.674857616236926;0.933043388215802,0.668696282489386,0.668696282489386;0.933923578751165,0.662534948741845,0.662534948741845;0.934803769286528,0.656373614994304,0.656373614994304;0.935683959821891,0.650212281246764,0.650212281246764;0.936564150357254,0.644050947499224,0.644050947499224;0.937444340892617,0.637889613751683,0.637889613751683;0.938324531427980,0.631728280004143,0.631728280004143;0.939204721963343,0.625566946256602,0.625566946256602;0.940084912498706,0.619405612509061,0.619405612509061;0.940965103034069,0.613244278761521,0.613244278761521;0.941845293569432,0.607082945013980,0.607082945013980;0.942725484104795,0.600921611266439,0.600921611266439;0.943605674640158,0.594760277518898,0.594760277518898;0.944485865175521,0.588598943771358,0.588598943771358;0.945366055710884,0.582437610023817,0.582437610023817;0.946246246246247,0.576276276276276,0.576276276276276;0.947126436781610,0.570114942528736,0.570114942528736;0.948006627316973,0.563953608781195,0.563953608781195;0.948886817852335,0.557792275033654,0.557792275033654;0.949767008387698,0.551630941286114,0.551630941286114;0.950647198923061,0.545469607538573,0.545469607538573;0.951527389458424,0.539308273791033,0.539308273791033;0.952407579993786,0.533146940043493,0.533146940043493;0.953287770529149,0.526985606295952,0.526985606295952;0.954167961064512,0.520824272548411,0.520824272548411;0.955048151599875,0.514662938800870,0.514662938800870;0.955928342135238,0.508501605053329,0.508501605053329;0.956808532670601,0.502340271305789,0.502340271305789;0.957688723205964,0.496178937558248,0.496178937558248;0.958568913741327,0.490017603810707,0.490017603810707;0.959449104276690,0.483856270063166,0.483856270063166;0.960329294812053,0.477694936315626,0.477694936315626;0.961209485347416,0.471533602568085,0.471533602568085;0.962089675882779,0.465372268820544,0.465372268820544;0.962969866418142,0.459210935073004,0.459210935073004;0.963850056953505,0.453049601325464,0.453049601325464;0.964730247488868,0.446888267577923,0.446888267577923;0.965610438024231,0.440726933830382,0.440726933830382;0.966490628559594,0.434565600082842,0.434565600082842;0.967370819094957,0.428404266335301,0.428404266335301;0.968251009630320,0.422242932587760,0.422242932587760;0.969131200165683,0.416081598840219,0.416081598840219;0.970011390701046,0.409920265092679,0.409920265092679;0.970891581236409,0.403758931345138,0.403758931345138;0.971771771771772,0.397597597597597,0.397597597597597;0.972651962307134,0.391436263850057,0.391436263850057;0.973532152842497,0.385274930102516,0.385274930102516;0.974412343377860,0.379113596354975,0.379113596354975;0.975292533913223,0.372952262607435,0.372952262607435;0.976172724448586,0.366790928859894,0.366790928859894;0.977052914983949,0.360629595112353,0.360629595112353;0.977933105519312,0.354468261364812,0.354468261364812;0.978813296054675,0.348306927617272,0.348306927617272;0.979693486590038,0.342145593869731,0.342145593869731;0.980573677125401,0.335984260122191,0.335984260122191;0.981453867660764,0.329822926374651,0.329822926374651;0.982334058196127,0.323661592627110,0.323661592627110;0.983214248731490,0.317500258879569,0.317500258879569;0.984094439266853,0.311338925132029,0.311338925132029;0.984974629802216,0.305177591384488,0.305177591384488;0.985854820337579,0.299016257636947,0.299016257636947;0.986735010872942,0.292854923889407,0.292854923889407;0.987615201408305,0.286693590141866,0.286693590141866;0.988495391943668,0.280532256394325,0.280532256394325;0.989375582479031,0.274370922646785,0.274370922646785;0.990255773014394,0.268209588899244,0.268209588899244;0.991135963549757,0.262048255151703,0.262048255151703;0.992016154085120,0.255886921404162,0.255886921404162;0.992896344620483,0.249725587656622,0.249725587656622;0.993776535155846,0.243564253909081,0.243564253909081;0.994656725691208,0.237402920161540,0.237402920161540;0.995536916226571,0.231241586414000,0.231241586414000;0.996417106761934,0.225080252666460,0.225080252666460;0.997297297297297,0.218918918918919,0.218918918918919;0.998177487832660,0.212757585171379,0.212757585171379;0.999057678368023,0.206596251423838,0.206596251423838;0.999937868903386,0.200434917676297,0.200434917676297;0.998789605932463,0.199515842372985,0.199515842372985;0.997487283201569,0.198994913280627,0.198994913280627;0.996184960470675,0.198473984188270,0.198473984188270;0.994882637739781,0.197953055095912,0.197953055095912;0.993580315008887,0.197432126003554,0.197432126003554;0.992277992277993,0.196911196911197,0.196911196911197;0.990975669547098,0.196390267818839,0.196390267818839;0.989673346816204,0.195869338726482,0.195869338726482;0.988371024085310,0.195348409634124,0.195348409634124;0.987068701354416,0.194827480541766,0.194827480541766;0.985766378623521,0.194306551449409,0.194306551449409;0.984464055892627,0.193785622357051,0.193785622357051;0.983161733161733,0.193264693264693,0.193264693264693;0.981859410430839,0.192743764172336,0.192743764172336;0.980557087699945,0.192222835079978,0.192222835079978;0.979254764969051,0.191701905987621,0.191701905987621;0.977952442238157,0.191180976895263,0.191180976895263;0.976650119507262,0.190660047802905,0.190660047802905;0.975347796776368,0.190139118710547,0.190139118710547;0.974045474045474,0.189618189618190,0.189618189618190;0.972743151314580,0.189097260525832,0.189097260525832;0.971440828583686,0.188576331433474,0.188576331433474;0.970138505852792,0.188055402341116,0.188055402341116;0.968836183121898,0.187534473248759,0.187534473248759;0.967533860391003,0.187013544156401,0.187013544156401;0.966231537660109,0.186492615064044,0.186492615064044;0.964929214929215,0.185971685971686,0.185971685971686;0.963626892198321,0.185450756879329,0.185450756879329;0.962324569467427,0.184929827786971,0.184929827786971;0.961022246736533,0.184408898694613,0.184408898694613;0.959719924005639,0.183887969602255,0.183887969602255;0.958417601274744,0.183367040509898,0.183367040509898;0.957115278543850,0.182846111417540,0.182846111417540;0.955812955812956,0.182325182325182,0.182325182325182;0.954510633082062,0.181804253232824,0.181804253232824;0.953208310351167,0.181283324140467,0.181283324140467;0.951905987620273,0.180762395048109,0.180762395048109;0.950603664889379,0.180241465955752,0.180241465955752;0.949301342158485,0.179720536863394,0.179720536863394;0.947999019427591,0.179199607771036,0.179199607771036;0.946696696696697,0.178678678678679,0.178678678678679;0.945394373965803,0.178157749586321,0.178157749586321;0.944092051234908,0.177636820493963,0.177636820493963;0.942789728504014,0.177115891401606,0.177115891401606;0.941487405773120,0.176594962309248,0.176594962309248;0.940185083042226,0.176074033216891,0.176074033216891;0.938882760311332,0.175553104124533,0.175553104124533;0.937580437580438,0.175032175032175,0.175032175032175;0.936278114849544,0.174511245939818,0.174511245939818;0.934975792118649,0.173990316847460,0.173990316847460;0.933673469387755,0.173469387755102,0.173469387755102;0.932371146656861,0.172948458662744,0.172948458662744;0.931068823925967,0.172427529570387,0.172427529570387;0.929766501195073,0.171906600478029,0.171906600478029;0.928464178464179,0.171385671385671,0.171385671385671;0.927161855733285,0.170864742293314,0.170864742293314;0.925859533002390,0.170343813200956,0.170343813200956;0.924557210271496,0.169822884108598,0.169822884108598;0.923254887540602,0.169301955016241,0.169301955016241;0.921952564809708,0.168781025923883,0.168781025923883;0.920650242078814,0.168260096831525,0.168260096831525;0.919347919347920,0.167739167739168,0.167739167739168;0.918045596617026,0.167218238646810,0.167218238646810;0.916743273886131,0.166697309554452,0.166697309554452;0.915440951155237,0.166176380462095,0.166176380462095;0.914138628424343,0.165655451369737,0.165655451369737;0.912836305693449,0.165134522277380,0.165134522277380;0.911533982962555,0.164613593185022,0.164613593185022;0.910231660231661,0.164092664092664,0.164092664092664;0.908929337500767,0.163571735000307,0.163571735000307;0.907627014769872,0.163050805907949,0.163050805907949;0.906324692038978,0.162529876815591,0.162529876815591;0.905022369308084,0.162008947723233,0.162008947723233;0.903720046577190,0.161488018630875,0.161488018630875;0.902417723846295,0.160967089538518,0.160967089538518;0.901115401115401,0.160446160446160,0.160446160446160;0.899813078384507,0.159925231353803,0.159925231353803;0.898510755653613,0.159404302261445,0.159404302261445;0.897208432922719,0.158883373169088,0.158883373169088;0.895906110191824,0.158362444076730,0.158362444076730;0.894603787460930,0.157841514984372,0.157841514984372;0.893301464730036,0.157320585892014,0.157320585892014;0.891999141999142,0.156799656799657,0.156799656799657;0.890696819268248,0.156278727707299,0.156278727707299;0.889394496537354,0.155757798614942,0.155757798614942;0.888092173806459,0.155236869522584,0.155236869522584;0.886789851075565,0.154715940430227,0.154715940430227;0.885487528344671,0.154195011337869,0.154195011337869;0.884185205613777,0.153674082245511,0.153674082245511;0.882882882882883,0.153153153153153,0.153153153153153;0.881580560151989,0.152632224060795,0.152632224060795;0.880278237421095,0.152111294968438,0.152111294968438;0.878975914690200,0.151590365876080,0.151590365876080;0.877673591959306,0.151069436783722,0.151069436783722;0.876371269228412,0.150548507691365,0.150548507691365;0.875068946497518,0.150027578599007,0.150027578599007;0.873766623766624,0.149506649506650,0.149506649506650;0.872464301035730,0.148985720414292,0.148985720414292;0.871161978304836,0.148464791321934,0.148464791321934;0.869859655573941,0.147943862229577,0.147943862229577;0.868557332843047,0.147422933137219,0.147422933137219;0.867255010112153,0.146902004044861,0.146902004044861;0.865952687381259,0.146381074952503,0.146381074952503;0.864650364650365,0.145860145860146,0.145860145860146;0.863348041919471,0.145339216767788,0.145339216767788;0.862045719188577,0.144818287675430,0.144818287675430;0.860743396457682,0.144297358583073,0.144297358583073;0.859441073726788,0.143776429490715,0.143776429490715;0.858138750995894,0.143255500398358,0.143255500398358;0.856836428265000,0.142734571306000,0.142734571306000;0.855534105534106,0.142213642213642,0.142213642213642;0.854231782803212,0.141692713121284,0.141692713121284;0.852929460072317,0.141171784028927,0.141171784028927;0.851627137341423,0.140650854936569,0.140650854936569;0.850324814610529,0.140129925844212,0.140129925844212;0.849022491879635,0.139608996751854,0.139608996751854;0.847720169148741,0.139088067659496,0.139088067659496;0.846417846417847,0.138567138567139,0.138567138567139;0.845115523686952,0.138046209474781,0.138046209474781;0.843813200956058,0.137525280382423,0.137525280382423;0.842510878225164,0.137004351290066,0.137004351290066;0.841208555494270,0.136483422197708,0.136483422197708;0.839906232763376,0.135962493105350,0.135962493105350;0.838603910032482,0.135441564012992,0.135441564012992;0.837301587301587,0.134920634920635,0.134920634920635;0.835999264570693,0.134399705828277,0.134399705828277;0.834696941839799,0.133878776735919,0.133878776735919;0.833394619108905,0.133357847643562,0.133357847643562;0.832092296378011,0.132836918551204,0.132836918551204;0.830789973647117,0.132315989458847,0.132315989458847;0.829487650916223,0.131795060366489,0.131795060366489;0.828185328185328,0.131274131274131,0.131274131274131;0.826883005454434,0.130753202181773,0.130753202181773;0.825580682723540,0.130232273089416,0.130232273089416;0.824278359992646,0.129711343997058,0.129711343997058;0.822976037261751,0.129190414904701,0.129190414904701;0.821673714530857,0.128669485812343,0.128669485812343;0.820371391799963,0.128148556719986,0.128148556719986;0.819069069069069,0.127627627627628,0.127627627627628;0.817766746338175,0.127106698535270,0.127106698535270;0.816464423607281,0.126585769442912,0.126585769442912;0.815162100876387,0.126064840350555,0.126064840350555;0.813859778145492,0.125543911258197,0.125543911258197;0.812557455414598,0.125022982165839,0.125022982165839;0.811255132683704,0.124502053073481,0.124502053073481;0.809952809952810,0.123981123981124,0.123981123981124;0.808650487221916,0.123460194888766,0.123460194888766;0.807348164491022,0.122939265796409,0.122939265796409;0.806045841760128,0.122418336704051,0.122418336704051;0.804743519029233,0.121897407611694,0.121897407611694;0.803441196298339,0.121376478519336,0.121376478519336;0.802138873567445,0.120855549426978,0.120855549426978;0.800836550836551,0.120334620334620,0.120334620334620;0.799534228105657,0.119813691242262,0.119813691242262;0.798231905374762,0.119292762149905,0.119292762149905;0.796929582643869,0.118771833057547,0.118771833057547;0.795627259912974,0.118250903965189,0.118250903965189;0.794324937182080,0.117729974872832,0.117729974872832;0.793022614451186,0.117209045780474,0.117209045780474;0.791720291720292,0.116688116688117,0.116688116688117;0.790417968989397,0.116167187595759,0.116167187595759;0.789115646258503,0.115646258503401,0.115646258503401;0.787813323527609,0.115125329411044,0.115125329411044;0.786511000796715,0.114604400318686,0.114604400318686;0.785208678065821,0.114083471226328,0.114083471226328;0.783906355334927,0.113562542133971,0.113562542133971;0.782604032604033,0.113041613041613,0.113041613041613;0.781301709873138,0.112520683949256,0.112520683949256;0.779999387142244,0.111999754856898,0.111999754856898;0.778697064411350,0.111478825764540,0.111478825764540;0.777394741680456,0.110957896672182,0.110957896672182;0.776092418949562,0.110436967579825,0.110436967579825;0.774790096218668,0.109916038487467,0.109916038487467;0.773487773487774,0.109395109395109,0.109395109395109;0.772185450756879,0.108874180302751,0.108874180302751;0.770883128025985,0.108353251210394,0.108353251210394;0.769580805295091,0.107832322118036,0.107832322118036;0.768278482564197,0.107311393025679,0.107311393025679;0.766976159833303,0.106790463933321,0.106790463933321;0.765673837102409,0.106269534840964,0.106269534840964;0.764371514371515,0.105748605748606,0.105748605748606;0.763069191640621,0.105227676656248,0.105227676656248;0.761766868909726,0.104706747563890,0.104706747563890;0.760464546178832,0.104185818471533,0.104185818471533;0.759162223447938,0.103664889379175,0.103664889379175;0.757859900717044,0.103143960286818,0.103143960286818;0.756557577986150,0.102623031194460,0.102623031194460;0.755255255255256,0.102102102102102,0.102102102102102;0.753952932524362,0.101581173009745,0.101581173009745;0.752650609793467,0.101060243917387,0.101060243917387;0.751348287062573,0.100539314825029,0.100539314825029;0.750045964331679,0.100018385732671,0.100018385732671;0.748743641600785,0.0994974566403138,0.0994974566403138;0.747441318869891,0.0989765275479561,0.0989765275479561;0.746138996138997,0.0984555984555985,0.0984555984555985;0.744836673408102,0.0979346693632408,0.0979346693632408;0.743534350677208,0.0974137402708831,0.0974137402708831;0.742232027946314,0.0968928111785255,0.0968928111785255;0.740929705215420,0.0963718820861678,0.0963718820861678;0.739627382484525,0.0958509529938102,0.0958509529938102;0.738325059753631,0.0953300239014525,0.0953300239014525;0.737022737022737,0.0948090948090948,0.0948090948090948;0.735720414291843,0.0942881657167371,0.0942881657167371;0.734418091560948,0.0937672366243794,0.0937672366243794;0.733115768830054,0.0932463075320218,0.0932463075320218;0.731813446099160,0.0927253784396641,0.0927253784396641;0.730511123368266,0.0922044493473064,0.0922044493473064;0.729208800637372,0.0916835202549488,0.0916835202549488;0.727906477906478,0.0911625911625911,0.0911625911625911;0.726604155175584,0.0906416620702334,0.0906416620702334;0.725301832444689,0.0901207329778758,0.0901207329778758;0.723999509713795,0.0895998038855181,0.0895998038855181;0.722697186982901,0.0890788747931605,0.0890788747931605;0.721394864252007,0.0885579457008028,0.0885579457008028;0.720092541521113,0.0880370166084452,0.0880370166084452;0.718790218790219,0.0875160875160875,0.0875160875160875;0.717487896059325,0.0869951584237298,0.0869951584237298;0.716185573328430,0.0864742293313722,0.0864742293313722;0.714883250597536,0.0859533002390145,0.0859533002390145;0.713580927866642,0.0854323711466568,0.0854323711466568;0.712278605135748,0.0849114420542992,0.0849114420542992;0.710976282404854,0.0843905129619415,0.0843905129619415;0.709673959673960,0.0838695838695839,0.0838695838695839;0.708371636943066,0.0833486547772262,0.0833486547772262;0.707069314212172,0.0828277256848686,0.0828277256848686;0.705766991481277,0.0823067965925109,0.0823067965925109;0.704464668750383,0.0817858675001532,0.0817858675001532;0.703162346019489,0.0812649384077956,0.0812649384077956;0.701860023288595,0.0807440093154379,0.0807440093154379;0.700557700557701,0.0802230802230802,0.0802230802230802;0.699255377826807,0.0797021511307226,0.0797021511307226;0.697953055095912,0.0791812220383649,0.0791812220383649;0.696650732365018,0.0786602929460072,0.0786602929460072;0.695348409634124,0.0781393638536496,0.0781393638536496;0.694046086903230,0.0776184347612919,0.0776184347612919;0.692743764172336,0.0770975056689342,0.0770975056689342;0.691441441441442,0.0765765765765766,0.0765765765765766;0.690139118710548,0.0760556474842189,0.0760556474842189;0.688836795979654,0.0755347183918612,0.0755347183918612;0.687534473248759,0.0750137892995035,0.0750137892995035;0.686232150517865,0.0744928602071459,0.0744928602071459;0.684929827786971,0.0739719311147882,0.0739719311147882;0.683627505056076,0.0734510020224305,0.0734510020224305;0.682325182325182,0.0729300729300729,0.0729300729300729;0.681022859594288,0.0724091438377152,0.0724091438377152;0.679720536863394,0.0718882147453576,0.0718882147453576;0.678418214132500,0.0713672856529999,0.0713672856529999;0.677115891401606,0.0708463565606423,0.0708463565606423;0.675813568670712,0.0703254274682846,0.0703254274682846;0.674511245939818,0.0698044983759270,0.0698044983759270;0.673208923208923,0.0692835692835693,0.0692835692835693;0.671906600478029,0.0687626401912116,0.0687626401912116;0.670604277747135,0.0682417110988539,0.0682417110988539;0.669301955016241,0.0677207820064963,0.0677207820064963;0.667999632285347,0.0671998529141386,0.0671998529141386;0.666697309554453,0.0666789238217810,0.0666789238217810;0.665394986823559,0.0661579947294233,0.0661579947294233;0.664092664092664,0.0656370656370656,0.0656370656370656;0.662790341361770,0.0651161365447080,0.0651161365447080;0.661488018630876,0.0645952074523503,0.0645952074523503;0.660185695899982,0.0640742783599927,0.0640742783599927;0.658883373169088,0.0635533492676350,0.0635533492676350;0.657581050438194,0.0630324201752774,0.0630324201752774;0.656278727707300,0.0625114910829197,0.0625114910829197;0.654976404976405,0.0619905619905620,0.0619905619905620;0.653674082245511,0.0614696328982044,0.0614696328982044;0.652371759514617,0.0609487038058467,0.0609487038058467;0.651069436783722,0.0604277747134890,0.0604277747134890;0.649767114052828,0.0599068456211313,0.0599068456211313;0.648464791321934,0.0593859165287737,0.0593859165287737;0.647162468591040,0.0588649874364160,0.0588649874364160;0.645860145860146,0.0583440583440583,0.0583440583440583;0.644557823129252,0.0578231292517007,0.0578231292517007;0.643255500398358,0.0573022001593430,0.0573022001593430;0.641953177667463,0.0567812710669853,0.0567812710669853;0.640650854936569,0.0562603419746277,0.0562603419746277;0.639348532205675,0.0557394128822700,0.0557394128822700;0.638046209474781,0.0552184837899123,0.0552184837899123;0.636743886743887,0.0546975546975547,0.0546975546975547;0.635441564012993,0.0541766256051970,0.0541766256051970;0.634139241282099,0.0536556965128393,0.0536556965128393;0.632836918551205,0.0531347674204817,0.0531347674204817;0.631534595820310,0.0526138383281240,0.0526138383281240;0.630232273089416,0.0520929092357664,0.0520929092357664;0.628929950358522,0.0515719801434087,0.0515719801434087;0.627627627627627,0.0510510510510511,0.0510510510510511;0.626325304896733,0.0505301219586934,0.0505301219586934;0.625022982165839,0.0500091928663357,0.0500091928663357;0.623720659434945,0.0494882637739781,0.0494882637739781;0.622418336704051,0.0489673346816204,0.0489673346816204;0.621116013973157,0.0484464055892627,0.0484464055892627;0.619813691242263,0.0479254764969051,0.0479254764969051;0.618511368511368,0.0474045474045474,0.0474045474045474;0.617209045780474,0.0468836183121898,0.0468836183121898;0.615906723049580,0.0463626892198321,0.0463626892198321;0.614604400318686,0.0458417601274745,0.0458417601274745;0.613302077587792,0.0453208310351168,0.0453208310351168;0.611999754856898,0.0447999019427591,0.0447999019427591;0.610697432126004,0.0442789728504014,0.0442789728504014;0.609395109395110,0.0437580437580437,0.0437580437580437;0.608092786664215,0.0432371146656860,0.0432371146656860;0.606790463933321,0.0427161855733284,0.0427161855733284;0.605488141202427,0.0421952564809707,0.0421952564809707;0.604185818471533,0.0416743273886130,0.0416743273886130;0.602883495740639,0.0411533982962554,0.0411533982962554;0.601581173009745,0.0406324692038977,0.0406324692038977;0.600278850278850,0.0401115401115401,0.0401115401115401;0.598976527547956,0.0395906110191824,0.0395906110191824;0.597674204817062,0.0390696819268248,0.0390696819268248;0.596371882086168,0.0385487528344671,0.0385487528344671;0.595069559355274,0.0380278237421094,0.0380278237421094;0.593767236624380,0.0375068946497518,0.0375068946497518;0.592464913893486,0.0369859655573941,0.0369859655573941;0.591162591162591,0.0364650364650364,0.0364650364650364;0.589860268431697,0.0359441073726788,0.0359441073726788;0.588557945700803,0.0354231782803211,0.0354231782803211;0.587255622969909,0.0349022491879635,0.0349022491879635;0.585953300239015,0.0343813200956058,0.0343813200956058;0.584650977508121,0.0338603910032482,0.0338603910032482;0.583348654777227,0.0333394619108905,0.0333394619108905;0.582046332046333,0.0328185328185329,0.0328185328185329;0.580744009315438,0.0322976037261752,0.0322976037261752;0.579441686584544,0.0317766746338175,0.0317766746338175;0.578139363853650,0.0312557455414598,0.0312557455414598;0.576837041122756,0.0307348164491022,0.0307348164491022;0.575534718391861,0.0302138873567445,0.0302138873567445;0.574232395660967,0.0296929582643868,0.0296929582643868;0.572930072930073,0.0291720291720292,0.0291720291720292;0.571627750199178,0.0286511000796715,0.0286511000796715;0.570325427468284,0.0281301709873139,0.0281301709873139;0.569023104737390,0.0276092418949562,0.0276092418949562;0.567720782006496,0.0270883128025986,0.0270883128025986;0.566418459275602,0.0265673837102409,0.0265673837102409;0.565116136544708,0.0260464546178832,0.0260464546178832;0.563813813813814,0.0255255255255255,0.0255255255255255;0.562511491082919,0.0250045964331678,0.0250045964331678;0.561209168352025,0.0244836673408101,0.0244836673408101;0.559906845621131,0.0239627382484525,0.0239627382484525;0.558604522890237,0.0234418091560948,0.0234418091560948;0.557302200159343,0.0229208800637371,0.0229208800637371;0.555999877428449,0.0223999509713795,0.0223999509713795;0.554697554697555,0.0218790218790218,0.0218790218790218;0.553395231966660,0.0213580927866642,0.0213580927866642;0.552092909235766,0.0208371636943066,0.0208371636943066;0.550790586504872,0.0203162346019489,0.0203162346019489;0.549488263773978,0.0197953055095912,0.0197953055095912;0.548185941043084,0.0192743764172336,0.0192743764172336;0.546883618312190,0.0187534473248759,0.0187534473248759;0.545581295581296,0.0182325182325182,0.0182325182325182;0.544278972850401,0.0177115891401605,0.0177115891401605;0.542976650119507,0.0171906600478029,0.0171906600478029;0.541674327388613,0.0166697309554452,0.0166697309554452;0.540372004657719,0.0161488018630876,0.0161488018630876;0.539069681926825,0.0156278727707299,0.0156278727707299;0.537767359195931,0.0151069436783723,0.0151069436783723;0.536465036465037,0.0145860145860146,0.0145860145860146;0.535162713734143,0.0140650854936570,0.0140650854936570;0.533860391003248,0.0135441564012993,0.0135441564012993;0.532558068272354,0.0130232273089416,0.0130232273089416;0.531255745541460,0.0125022982165840,0.0125022982165840;0.529953422810566,0.0119813691242263,0.0119813691242263;0.528651100079671,0.0114604400318686,0.0114604400318686;0.527348777348778,0.0109395109395109,0.0109395109395109;0.526046454617884,0.0104185818471532,0.0104185818471532;0.524744131886989,0.00989765275479555,0.00989765275479555;0.523441809156095,0.00937672366243789,0.00937672366243789;0.522139486425201,0.00885579457008029,0.00885579457008029;0.520837163694307,0.00833486547772262,0.00833486547772262;0.519534840963412,0.00781393638536495,0.00781393638536495;0.518232518232518,0.00729300729300733,0.00729300729300733;0.516930195501624,0.00677207820064965,0.00677207820064965;0.515627872770730,0.00625114910829197,0.00625114910829197;0.514325550039836,0.00573022001593434,0.00573022001593434;0.513023227308942,0.00520929092357665,0.00520929092357665;0.511720904578048,0.00468836183121897,0.00468836183121897;0.510418581847153,0.00416743273886133,0.00416743273886133;0.509116259116259,0.00364650364650365,0.00364650364650365;0.507813936385365,0.00312557455414597,0.00312557455414597;0.506511613654471,0.00260464546178829,0.00260464546178829;0.505209290923577,0.00208371636943067,0.00208371636943067;0.503906968192683,0.00156278727707299,0.00156278727707299;0.502604645461789,0.00104185818471530,0.00104185818471530;0.501302322730894,0.000520929092357681,0.000520929092357681;0.500000000000000,0,0];

%%% ===========================================================
%% PART 1: m = const 
m = 0.0

%% Calculate the dispersion and Berry curvature 
E1_array = zeros(Nk,Nq);
E2_array = zeros(Nk,Nq);
E3_array = zeros(Nk,Nq);
E4_array = zeros(Nk,Nq);
E5_array = zeros(Nk,Nq);
E6_array = zeros(Nk,Nq);
E7_array = zeros(Nk,Nq);
E8_array = zeros(Nk,Nq);

Fkq1_array = zeros(Nk,Nq);
Fkq2_array = zeros(Nk,Nq);
Fkq3_array = zeros(Nk,Nq);
Fkq4_array = zeros(Nk,Nq);
Fkq5_array = zeros(Nk,Nq);
Fkq6_array = zeros(Nk,Nq);
Fkq7_array = zeros(Nk,Nq);
Fkq8_array = zeros(Nk,Nq);

Fqm1_array = zeros(Nk,Nq);
Fqm2_array = zeros(Nk,Nq);
Fqm3_array = zeros(Nk,Nq);
Fqm4_array = zeros(Nk,Nq);
Fqm5_array = zeros(Nk,Nq);
Fqm6_array = zeros(Nk,Nq);
Fqm7_array = zeros(Nk,Nq);
Fqm8_array = zeros(Nk,Nq);

Fmk1_array = zeros(Nk,Nq);
Fmk2_array = zeros(Nk,Nq);
Fmk3_array = zeros(Nk,Nq);
Fmk4_array = zeros(Nk,Nq);
Fmk5_array = zeros(Nk,Nq);
Fmk6_array = zeros(Nk,Nq);
Fmk7_array = zeros(Nk,Nq);
Fmk8_array = zeros(Nk,Nq);

% Scan the arrays of genuine and synthetic momenta 
for ik = 1:Nk
    k = k_array(ik);

    for iq = 1:Nq 
        q = q_array(iq);

        % The Hamiltonian 
        H = Hamiltonian(k,q,m,omega,v,U,W,ro,rv,rW,eta,alpha,V,beta,dist,d0);

        % Diagonalize the Hamiltonian
        [Vec,D] = eig(H);
        [eigval,ind] = sort(diag(D));
        eigval = real(eigval);
        Ds = D(ind,ind);
        eigvec = Vec(:,ind);
        
        % Save the energy eigenvalues to array 
        E1_array(ik,iq) = eigval(1);
        E2_array(ik,iq) = eigval(2);
        E3_array(ik,iq) = eigval(3);
        E4_array(ik,iq) = eigval(4);
        E5_array(ik,iq) = eigval(5);
        E6_array(ik,iq) = eigval(6);
        E7_array(ik,iq) = eigval(7);
        E8_array(ik,iq) = eigval(8);

        % Calculate the matrix elements:
        % <n|dH/dk|l>, <n|dH/dq|l>, <n|dH/dm|l>
        dHk = dH_k(k,q,m,v,rv,V,beta,dist,d0);
        dHke = eigvec'*dHk*eigvec;

        dHq = dH_q(k,q,V,beta,dist,d0);
        dHqe = eigvec'*dHq*eigvec;

        dHm = dH_m(k,omega,v,U,W,alpha,ro,rv,rW);
        dHme = eigvec'*dHm*eigvec;

        % Calculate the Berry curvature of band 1 and band 2 
        for l = 1:8
            if (l ~= 1)
                Fkq1_array(ik,iq) = Fkq1_array(ik,iq) - 2*imag(dHke(1,l)*dHqe(l,1))/(eigval(1)-eigval(l))^2;
                Fqm1_array(ik,iq) = Fqm1_array(ik,iq) - 2*imag(dHqe(1,l)*dHme(l,1))/(eigval(1)-eigval(l))^2;
                Fmk1_array(ik,iq) = Fmk1_array(ik,iq) - 2*imag(dHme(1,l)*dHke(l,1))/(eigval(1)-eigval(l))^2;
            end % IF l~=1 

            if (l ~= 2)
                Fkq2_array(ik,iq) = Fkq2_array(ik,iq) - 2*imag(dHke(2,l)*dHqe(l,2))/(eigval(2)-eigval(l))^2;
                Fqm2_array(ik,iq) = Fqm2_array(ik,iq) - 2*imag(dHqe(2,l)*dHme(l,2))/(eigval(2)-eigval(l))^2;
                Fmk2_array(ik,iq) = Fmk2_array(ik,iq) - 2*imag(dHme(2,l)*dHke(l,2))/(eigval(2)-eigval(l))^2;
            end % IF l~=2
        end % l-loop 

    end % iq-loop   
end % ik-loop

%% Plot the dispersion surfaces with Berry curvature
figure(1);
set(1,'Position',[10 50 1500 700]);
sgt = sgtitle(['m = ',num2str(m)]);
sgt.FontName = 'Book Antiqua';
sgt.FontSize = 20; 

% F_{kq}
subplot(2,3,1);
surf(k_array,q_array,E1_array',Fkq1_array');hold on;
surf(k_array,q_array,E2_array',Fkq2_array');
hold off;
shading flat;

Fkq1max = max(abs(Fkq1_array),[],'all');
Fkq2max = max(abs(Fkq2_array),[],'all');
Fkqmax = 0.1*max(Fkq1max,Fkq2max)+1e-9;

colormap(gca,Berry_map2)
c = colorbar;
c.Label.String = 'F_{kq}';
c.Label.FontSize = 16;
clim([-Fkqmax Fkqmax]);
% Lighting
h=light;
for i_light=1:1
    h2=camlight(100,-45);
end
material dull

xticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
yticks([-0.5,-0.25,0,0.25,0.5]);
xlabel('k','FontSize',18);
ylabel('q','Fontsize',18);
zlabel('E','FontSize',18);

% F_{qm}
subplot(2,3,2);
surf(k_array,q_array,E1_array',Fqm1_array');hold on;
surf(k_array,q_array,E2_array',Fqm2_array');
hold off;
shading flat;

Fqm1max = max(abs(Fqm1_array),[],'all');
Fqm2max = max(abs(Fqm2_array),[],'all');
Fqmmax = max(Fqm1max,Fqm2max)+1e-9;

colormap(gca,Berry_map2)
c = colorbar;
c.Label.String = 'F_{qm}';
c.Label.FontSize = 16;
clim([-Fqmmax Fqmmax]);
% Lighting
h=light;
for i_light=1:1
    h2=camlight(100,-45);
end
material dull

xticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
yticks([-0.5,-0.25,0,0.25,0.5]);
xlabel('k','FontSize',18);
ylabel('q','Fontsize',18);
zlabel('E','FontSize',18);

% F_{mk}
subplot(2,3,3);
surf(k_array,q_array,E1_array',Fmk1_array');hold on;
surf(k_array,q_array,E2_array',Fmk2_array');
hold off;
shading flat;

Fmk1max = max(abs(Fmk1_array),[],'all');
Fmk2max = max(abs(Fmk2_array),[],'all');
Fmkmax = max(Fmk1max,Fmk2max)+1e-9;

colormap(gca,Berry_map2)
c = colorbar;
c.Label.String = 'F_{mk}';
c.Label.FontSize = 16;
clim([-Fmkmax Fmkmax]);
% Lighting
h=light;
for i_light=1:1
    h2=camlight(100,-45);
end
material dull

xticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
yticks([-0.5,-0.25,0,0.25,0.5]);
xlabel('k','FontSize',18);
ylabel('q','Fontsize',18);
zlabel('E','FontSize',18);

% F_{kq}
subplot(2,3,4);
pcolor(k_array,q_array,Fkq1_array');
colormap(gca,Berry_map2);
shading flat;
xticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
yticks([-Qmax,-0.5*Qmax,0,0.5*Qmax,Qmax]);
xlabel('k','FontSize',18);
ylabel('q','FontSize',18);
c=colorbar;
c.Label.String = 'F_m = F_{kq}';
c.Label.FontSize = 16;
clim([-Fkqmax Fkqmax]);
set(gca,'FontName','Book Antiqua','FontSize',20);

% F_{qm}
subplot(2,3,5);
pcolor(k_array,q_array,Fqm1_array');
colormap(gca,Berry_map2);
shading flat;
xticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
yticks([-Qmax,-0.5*Qmax,0,0.5*Qmax,Qmax]);
xlabel('k','FontSize',18);
ylabel('q','FontSize',18);
c=colorbar;
c.Label.String = 'F_k = F_{qm}';
c.Label.FontSize = 16;
clim([-Fqmmax Fqmmax]);
set(gca,'FontName','Book Antiqua','FontSize',20);

% F_{mk}
subplot(2,3,6);
pcolor(k_array,q_array,Fmk1_array');
colormap(gca,Berry_map2);
shading flat;
xticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
yticks([-Qmax,-0.5*Qmax,0,0.5*Qmax,Qmax]);
xlabel('k','FontSize',18);
ylabel('q','FontSize',18);
c=colorbar;
c.Label.String = 'F_q = F_{mk}';
c.Label.FontSize = 16;
clim([-Fmkmax Fmkmax]);
set(gca,'FontName','Book Antiqua','FontSize',20);

%%% ===========================================================
%% PART 2: k = const 
k = 0.0

%% Calculate the dispersion and Berry curvature 
E1_array = zeros(Nq,Nm);
E2_array = zeros(Nq,Nm);
E3_array = zeros(Nq,Nm);
E4_array = zeros(Nq,Nm);
E5_array = zeros(Nq,Nm);
E6_array = zeros(Nq,Nm);
E7_array = zeros(Nq,Nm);
E8_array = zeros(Nq,Nm);

Fkq1_array = zeros(Nq,Nm);
Fkq2_array = zeros(Nq,Nm);
Fkq3_array = zeros(Nq,Nm);
Fkq4_array = zeros(Nq,Nm);
Fkq5_array = zeros(Nq,Nm);
Fkq6_array = zeros(Nq,Nm);
Fkq7_array = zeros(Nq,Nm);
Fkq8_array = zeros(Nq,Nm);

Fqm1_array = zeros(Nq,Nm);
Fqm2_array = zeros(Nq,Nm);
Fqm3_array = zeros(Nq,Nm);
Fqm4_array = zeros(Nq,Nm);
Fqm5_array = zeros(Nq,Nm);
Fqm6_array = zeros(Nq,Nm);
Fqm7_array = zeros(Nq,Nm);
Fqm8_array = zeros(Nq,Nm);

Fmk1_array = zeros(Nq,Nm);
Fmk2_array = zeros(Nq,Nm);
Fmk3_array = zeros(Nq,Nm);
Fmk4_array = zeros(Nq,Nm);
Fmk5_array = zeros(Nq,Nm);
Fmk6_array = zeros(Nq,Nm);
Fmk7_array = zeros(Nq,Nm);
Fmk8_array = zeros(Nq,Nm);

% Scan the arrays of genuine and synthetic momenta 
for iq = 1:Nq
    q = q_array(iq);

    for im = 1:Nm 
        m = m_array(im);

        % The Hamiltonian 
        H = Hamiltonian(k,q,m,omega,v,U,W,ro,rv,rW,eta,alpha,V,beta,dist,d0);

        % Diagonalize the Hamiltonian
        [Vec,D] = eig(H);
        [eigval,ind] = sort(diag(D));
        eigval = real(eigval);
        Ds = D(ind,ind);
        eigvec = Vec(:,ind);
        
        % Save the energy eigenvalues to array 
        E1_array(iq,im) = eigval(1);
        E2_array(iq,im) = eigval(2);
        E3_array(iq,im) = eigval(3);
        E4_array(iq,im) = eigval(4);
        E5_array(iq,im) = eigval(5);
        E6_array(iq,im) = eigval(6);
        E7_array(iq,im) = eigval(7);
        E8_array(iq,im) = eigval(8);

        % Calculate the matrix elements:
        % <n|dH/dk|l>, <n|dH/dq|l>, <n|dH/dm|l>
        dHk = dH_k(k,q,m,v,rv,V,beta,dist,d0);
        dHke = eigvec'*dHk*eigvec;

        dHq = dH_q(k,q,V,beta,dist,d0);
        dHqe = eigvec'*dHq*eigvec;

        dHm = dH_m(k,omega,v,U,W,alpha,ro,rv,rW);
        dHme = eigvec'*dHm*eigvec;

        % Calculate the Berry curvature of band 1 and band 2 
        for l = 1:8
            if (l ~= 1)
                Fkq1_array(iq,im) = Fkq1_array(iq,im) - 2*imag(dHke(1,l)*dHqe(l,1))/(eigval(1)-eigval(l))^2;
                Fqm1_array(iq,im) = Fqm1_array(iq,im) - 2*imag(dHqe(1,l)*dHme(l,1))/(eigval(1)-eigval(l))^2;
                Fmk1_array(iq,im) = Fmk1_array(iq,im) - 2*imag(dHme(1,l)*dHke(l,1))/(eigval(1)-eigval(l))^2;
            end % IF l~=1 

            if (l ~= 2)
                Fkq2_array(iq,im) = Fkq2_array(iq,im) - 2*imag(dHke(2,l)*dHqe(l,2))/(eigval(2)-eigval(l))^2;
                Fqm2_array(iq,im) = Fqm2_array(iq,im) - 2*imag(dHqe(2,l)*dHme(l,2))/(eigval(2)-eigval(l))^2;
                Fmk2_array(iq,im) = Fmk2_array(iq,im) - 2*imag(dHme(2,l)*dHke(l,2))/(eigval(2)-eigval(l))^2;
            end % IF l~=2
        end % l-loop 

    end % iq-loop   
end % ik-loop

%% Plot the dispersion surfaces with Berry curvature
figure(2);
set(2,'Position',[10 50 1500 700]);
sgt = sgtitle(['k = ',num2str(k)]);
sgt.FontName = 'Book Antiqua';
sgt.FontSize = 20; 

% F_{kq}
subplot(2,3,1);
surf(q_array,m_array,E1_array',Fkq1_array');hold on;
surf(q_array,m_array,E2_array',Fkq2_array');
hold off;
shading flat;

Fkq1max = max(abs(Fkq1_array),[],'all');
Fkq2max = max(abs(Fkq2_array),[],'all');
Fkqmax = max(Fkq1max,Fkq2max)+1e-9;

colormap(gca,Berry_map2)
c = colorbar;
c.Label.String = 'F_{kq}';
c.Label.FontSize = 16;
clim([-Fkqmax Fkqmax]);
% Lighting
h=light;
for i_light=1:1
    h2=camlight(100,-45);
end
material dull

xticks([-Qmax,-0.5*Qmax,0,0.5*Qmax,Qmax]);
yticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
xlabel('q','FontSize',18);
ylabel('m','Fontsize',18);
zlabel('E','FontSize',18);

% F_{qm}
subplot(2,3,2);
surf(q_array,m_array,E1_array',Fqm1_array');hold on;
surf(q_array,m_array,E2_array',Fqm2_array');
hold off;
shading flat;

Fqm1max = max(abs(Fqm1_array),[],'all');
Fqm2max = max(abs(Fqm2_array),[],'all');
Fqmmax = max(Fqm1max,Fqm2max)+1e-9;

colormap(gca,Berry_map2)
c = colorbar;
c.Label.String = 'F_{qm}';
c.Label.FontSize = 16;
clim([-Fqmmax Fqmmax]);
% Lighting
h=light;
for i_light=1:1
    h2=camlight(100,-45);
end
material dull

xticks([-Qmax,-0.5*Qmax,0,0.5*Qmax,Qmax]);
yticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
xlabel('q','FontSize',18);
ylabel('m','Fontsize',18);
zlabel('E','FontSize',18);

% F_{mk}
subplot(2,3,3);
surf(k_array,q_array,E1_array',Fmk1_array');hold on;
surf(k_array,q_array,E2_array',Fmk2_array');
hold off;
shading flat;

Fmk1max = max(abs(Fmk1_array),[],'all');
Fmk2max = max(abs(Fmk2_array),[],'all');
Fmkmax = max(Fmk1max,Fmk2max)+1e-9;

colormap(gca,Berry_map2)
c = colorbar;
c.Label.String = 'F_{mk}';
c.Label.FontSize = 16;
clim([-Fmkmax Fmkmax]);
% Lighting
h=light;
for i_light=1:1
    h2=camlight(100,-45);
end
material dull

xticks([-Qmax,-0.5*Qmax,0,0.5*Qmax,Qmax]);
yticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
xlabel('q','FontSize',18);
ylabel('m','Fontsize',18);
zlabel('E','FontSize',18);

% F_{kq}
subplot(2,3,4);
pcolor(q_array,m_array,Fkq1_array');
colormap(gca,Berry_map2);
shading flat;
xticks([-Qmax,-0.5*Qmax,0,0.5*Qmax,Qmax]);
yticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
xlabel('q','FontSize',18);
ylabel('m','FontSize',18);
c=colorbar;
c.Label.String = 'F_m = F_{kq}';
c.Label.FontSize = 16;
clim([-Fkqmax Fkqmax]);
set(gca,'FontName','Book Antiqua','FontSize',20);

% F_{qm}
subplot(2,3,5);
pcolor(q_array,m_array,Fqm1_array');
colormap(gca,Berry_map2);
shading flat;
xticks([-Qmax,-0.5*Qmax,0,0.5*Qmax,Qmax]);
yticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
xlabel('q','FontSize',18);
ylabel('m','FontSize',18);
c=colorbar;
c.Label.String = 'F_k = F_{qm}';
c.Label.FontSize = 16;
clim([-Fqmmax Fqmmax]);
set(gca,'FontName','Book Antiqua','FontSize',20);

% F_{mk}
subplot(2,3,6);
pcolor(q_array,m_array,Fmk1_array');
colormap(gca,Berry_map2);
shading flat;
xticks([-Qmax,-0.5*Qmax,0,0.5*Qmax,Qmax]);
yticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
xlabel('q','FontSize',18);
ylabel('m','FontSize',18);
c=colorbar;
c.Label.String = 'F_q = F_{mk}';
c.Label.FontSize = 16;
clim([-Fmkmax Fmkmax]);
set(gca,'FontName','Book Antiqua','FontSize',20);

%%% ===========================================================
%% PART 3: q = const 
q = 0.0

%% Calculate the dispersion and Berry curvature 
E1_array = zeros(Nm,Nq);
E2_array = zeros(Nm,Nq);
E3_array = zeros(Nm,Nq);
E4_array = zeros(Nm,Nq);
E5_array = zeros(Nm,Nq);
E6_array = zeros(Nm,Nq);
E7_array = zeros(Nm,Nq);
E8_array = zeros(Nm,Nq);

Fkq1_array = zeros(Nm,Nq);
Fkq2_array = zeros(Nm,Nq);
Fkq3_array = zeros(Nm,Nq);
Fkq4_array = zeros(Nm,Nq);
Fkq5_array = zeros(Nm,Nq);
Fkq6_array = zeros(Nm,Nq);
Fkq7_array = zeros(Nm,Nq);
Fkq8_array = zeros(Nm,Nq);

Fqm1_array = zeros(Nm,Nq);
Fqm2_array = zeros(Nm,Nq);
Fqm3_array = zeros(Nm,Nq);
Fqm4_array = zeros(Nm,Nq);
Fqm5_array = zeros(Nm,Nq);
Fqm6_array = zeros(Nm,Nq);
Fqm7_array = zeros(Nm,Nq);
Fqm8_array = zeros(Nm,Nq);

Fmk1_array = zeros(Nm,Nq);
Fmk2_array = zeros(Nm,Nq);
Fmk3_array = zeros(Nm,Nq);
Fmk4_array = zeros(Nm,Nq);
Fmk5_array = zeros(Nm,Nq);
Fmk6_array = zeros(Nm,Nq);
Fmk7_array = zeros(Nm,Nq);
Fmk8_array = zeros(Nm,Nq);

% Scan the arrays of genuine and synthetic momenta 
for im = 1:Nm
    m = m_array(im);

    for ik = 1:Nk 
        k = k_array(ik);

        % The Hamiltonian 
        H = Hamiltonian(k,q,m,omega,v,U,W,ro,rv,rW,eta,alpha,V,beta,dist,d0);

        % Diagonalize the Hamiltonian
        [Vec,D] = eig(H);
        [eigval,ind] = sort(diag(D));
        eigval = real(eigval);
        Ds = D(ind,ind);
        eigvec = Vec(:,ind);
        
        % Save the energy eigenvalues to array 
        E1_array(im,ik) = eigval(1);
        E2_array(im,ik) = eigval(2);
        E3_array(im,ik) = eigval(3);
        E4_array(im,ik) = eigval(4);
        E5_array(im,ik) = eigval(5);
        E6_array(im,ik) = eigval(6);
        E7_array(im,ik) = eigval(7);
        E8_array(im,ik) = eigval(8);

        % Calculate the matrix elements:
        % <n|dH/dk|l>, <n|dH/dq|l>, <n|dH/dm|l>
        dHk = dH_k(k,q,m,v,rv,V,beta,dist,d0);
        dHke = eigvec'*dHk*eigvec;

        dHq = dH_q(k,q,V,beta,dist,d0);
        dHqe = eigvec'*dHq*eigvec;

        dHm = dH_m(k,omega,v,U,W,alpha,ro,rv,rW);
        dHme = eigvec'*dHm*eigvec;

        % Calculate the Berry curvature of band 1 and band 2 
        for l = 1:8
            if (l ~= 1)
                Fkq1_array(im,ik) = Fkq1_array(im,ik) - 2*imag(dHke(1,l)*dHqe(l,1))/(eigval(1)-eigval(l))^2;
                Fqm1_array(im,ik) = Fqm1_array(im,ik) - 2*imag(dHqe(1,l)*dHme(l,1))/(eigval(1)-eigval(l))^2;
                Fmk1_array(im,ik) = Fmk1_array(im,ik) - 2*imag(dHme(1,l)*dHke(l,1))/(eigval(1)-eigval(l))^2;
            end % IF l~=1 

            if (l ~= 2)
                Fkq2_array(im,ik) = Fkq2_array(im,ik) - 2*imag(dHke(2,l)*dHqe(l,2))/(eigval(2)-eigval(l))^2;
                Fqm2_array(im,ik) = Fqm2_array(im,ik) - 2*imag(dHqe(2,l)*dHme(l,2))/(eigval(2)-eigval(l))^2;
                Fmk2_array(im,ik) = Fmk2_array(im,ik) - 2*imag(dHme(2,l)*dHke(l,2))/(eigval(2)-eigval(l))^2;
            end % IF l~=2
        end % l-loop 

    end % iq-loop   
end % ik-loop

%% Plot the dispersion surfaces with Berry curvature
figure(3);
set(3,'Position',[10 50 1500 700]);
sgt = sgtitle(['q = ',num2str(q)]);
sgt.FontName = 'Book Antiqua';
sgt.FontSize = 20; 

% F_{kq}
subplot(2,3,1);
surf(m_array,k_array,E1_array',Fkq1_array');hold on;
surf(m_array,k_array,E2_array',Fkq2_array');
hold off;
shading flat;

Fkq1max = max(abs(Fkq1_array),[],'all');
Fkq2max = max(abs(Fkq2_array),[],'all');
Fkqmax = max(Fkq1max,Fkq2max)+1e-9;

colormap(gca,Berry_map2)
c = colorbar;
c.Label.String = 'F_{kq}';
c.Label.FontSize = 16;
clim([-Fkqmax Fkqmax]);
% Lighting
h=light;
for i_light=1:1
    h2=camlight(100,-45);
end
material dull

xticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
yticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
xlabel('m','FontSize',18);
ylabel('k','Fontsize',18);
zlabel('E','FontSize',18);

% F_{qm}
subplot(2,3,2);
surf(m_array,k_array,E1_array',Fqm1_array');hold on;
surf(m_array,k_array,E2_array',Fqm2_array');
hold off;
shading flat;

Fqm1max = max(abs(Fqm1_array),[],'all');
Fqm2max = max(abs(Fqm2_array),[],'all');
Fqmmax = max(Fqm1max,Fqm2max)+1e-9;

colormap(gca,Berry_map2)
c = colorbar;
c.Label.String = 'F_{qm}';
c.Label.FontSize = 16;
clim([-Fqmmax Fqmmax]);
% Lighting
h=light;
for i_light=1:1
    h2=camlight(100,-45);
end
material dull

xticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
yticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
xlabel('m','FontSize',18);
ylabel('k','Fontsize',18);
zlabel('E','FontSize',18);

% F_{mk}
subplot(2,3,3);
surf(m_array,k_array,E1_array',Fmk1_array');hold on;
surf(m_array,k_array,E2_array',Fmk2_array');
hold off;
shading flat;

Fmk1max = max(abs(Fmk1_array),[],'all');
Fmk2max = max(abs(Fmk2_array),[],'all');
Fmkmax = max(Fmk1max,Fmk2max)+1e-9;

colormap(gca,Berry_map2)
c = colorbar;
c.Label.String = 'F_{mk}';
c.Label.FontSize = 16;
clim([-Fmkmax Fmkmax]);
% Lighting
h=light;
for i_light=1:1
    h2=camlight(100,-45);
end
material dull

xticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
yticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
xlabel('m','FontSize',18);
ylabel('k','Fontsize',18);
zlabel('E','FontSize',18);

% F_{kq}
subplot(2,3,4);
pcolor(m_array,k_array,Fkq1_array');
colormap(gca,Berry_map2);
shading flat;
xticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
yticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
xlabel('m','FontSize',18);
ylabel('k','FontSize',18);
c=colorbar;
c.Label.String = 'F_m = F_{kq}';
c.Label.FontSize = 16;
clim([-Fkqmax Fkqmax]);
set(gca,'FontName','Book Antiqua','FontSize',20);

% F_{qm}
subplot(2,3,5);
pcolor(m_array,k_array,Fqm1_array');
colormap(gca,Berry_map2);
shading flat;
xticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
yticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
xlabel('m','FontSize',18);
ylabel('k','FontSize',18);
c=colorbar;
c.Label.String = 'F_k = F_{qm}';
c.Label.FontSize = 16;
clim([-Fqmmax Fqmmax]);
set(gca,'FontName','Book Antiqua','FontSize',20);

% F_{mk}
subplot(2,3,6);
pcolor(m_array,k_array,Fmk1_array');
colormap(gca,Berry_map2);
shading flat;
xticks([-Mmax,-0.5*Mmax,0,0.5*Mmax,Mmax]);
yticks([-Kmax,-0.5*Kmax,0,0.5*Kmax,Kmax]);
xlabel('m','FontSize',18);
ylabel('k','FontSize',18);
c=colorbar;
c.Label.String = 'F_q = F_{mk}';
c.Label.FontSize = 16;
clim([-Fmkmax Fmkmax]);
set(gca,'FontName','Book Antiqua','FontSize',20);